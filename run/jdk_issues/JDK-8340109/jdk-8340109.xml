<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Sat Sep 27 09:19:48 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8340109] Ubsan: ciEnv.cpp:1660:65: runtime error: member call on null pointer of type &apos;struct CompileTask&apos;</title>
                <link>https://bugs.openjdk.org/browse/JDK-8340109</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>When running ubsan-enabled optimized  binaries on Linux x86_64, test &lt;br/&gt;
compiler/startup/StartupOutput.java&lt;br/&gt;
triggers this ubsan issue :&lt;br/&gt;
&lt;br/&gt;
jdk/src/hotspot/share/ci/ciEnv.cpp:1660:65: runtime error: member call on null pointer of type &amp;#39;struct CompileTask&amp;#39;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#0 0x7fe7443fc88d in ciEnv::dump_replay_data_helper(outputStream*) src/hotspot/share/ci/ciEnv.cpp:1660&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#1 0x7fe746c22047 in VMError::report_and_die(int, char const*, char const*, __va_list_tag*, Thread*, unsigned char*, void*, void*, char const*, int, unsigned long) src/hotspot/share/utilities/vmError.cpp:1872&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#2 0x7fe7447dd429 in report_fatal(VMErrorType, char const*, int, char const*, ...) src/hotspot/share/utilities/debug.cpp:214&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#3 0x7fe7445c614d in RuntimeStub::new_runtime_stub(char const*, CodeBuffer*, short, int, OopMapSet*, bool, bool) src/hotspot/share/code/codeBlob.cpp:413&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#4 0x7fe744259ceb in Runtime1::generate_blob(BufferBlob*, int, char const*, bool, StubAssemblerCodeGenClosure*) src/hotspot/share/c1/c1_Runtime1.cpp:230&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#5 0x7fe74425a273 in Runtime1::generate_blob_for(BufferBlob*, Runtime1::StubID) src/hotspot/share/c1/c1_Runtime1.cpp:259&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#6 0x7fe74425a273 in Runtime1::initialize(BufferBlob*) src/hotspot/share/c1/c1_Runtime1.cpp:268&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#7 0x7fe743fc04a1 in Compiler::init_c1_runtime() src/hotspot/share/c1/c1_Compiler.cpp:53&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#8 0x7fe743fc04a1 in Compiler::initialize() src/hotspot/share/c1/c1_Compiler.cpp:74&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#9 0x7fe7446aaad7 in CompileBroker::init_compiler_runtime() src/hotspot/share/compiler/compileBroker.cpp:1771&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#10 0x7fe7446b83cf in CompileBroker::compiler_thread_loop() src/hotspot/share/compiler/compileBroker.cpp:1913&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#11 0x7fe74516edca in JavaThread::thread_main_inner() src/hotspot/share/runtime/javaThread.cpp:758&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#12 0x7fe7469d3c9a in Thread::call_run() src/hotspot/share/runtime/thread.cpp:225&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#13 0x7fe746048cd1 in thread_native_entry src/hotspot/os/linux/os_linux.cpp:858&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#14 0x7fe74b1e66e9 in start_thread (/lib64/libpthread.so.0+0xa6e9) (BuildId: 052f7e2a0045f08cb7e7a291f8066a4b7be2521d)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#15 0x7fe74aaf158e in clone (/lib64/libc.so.6+0x11858e) (BuildId: cfb059a57e69ac95d5dadab831626b3bd48a4309)</description>
                <environment></environment>
        <key id="5139052">JDK-8340109</key>
            <summary>Ubsan: ciEnv.cpp:1660:65: runtime error: member call on null pointer of type &apos;struct CompileTask&apos;</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mbaesken">Matthias Baesken</assignee>
                                    <reporter username="mbaesken">Matthias Baesken</reporter>
                        <labels>
                            <label>ci-replay</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                            <label>jdk23u-fix-SQE-ok</label>
                            <label>jdk23u-fix-request</label>
                            <label>jdk23u-fix-yes</label>
                            <label>oracle-triage-24</label>
                            <label>starter</label>
                            <label>ubsan</label>
                    </labels>
                <created>Fri, 13 Sep 2024 03:38:43 -0700</created>
                <updated>Tue, 22 Oct 2024 05:42:15 -0700</updated>
                            <resolved>Wed, 2 Oct 2024 01:01:40 -0700</resolved>
                                    <version>18</version>
                    <version>21</version>
                    <version>23</version>
                    <version>24</version>
                                    <fixVersion>24</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14715773" author="mbaesken" created="Tue, 22 Oct 2024 05:38:58 -0700"  >Unfortunately we run now into the error below this, seems the check for nullptr needs to be done also at &lt;br/&gt;
ciInstanceKlass::dump_replay_instanceKlass(out, task()-&amp;gt;method()-&amp;gt;method_holder());&lt;br/&gt;
&lt;br/&gt;
test  compiler/startup/StartupOutput.java&lt;br/&gt;
&lt;br/&gt;
jdk/src/hotspot/share/ci/ciEnv.cpp:1614:65: runtime error: member call on null pointer of type &amp;#39;struct CompileTask&amp;#39;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#0 0x7fcea0810117 in ciEnv::dump_replay_data_helper(outputStream*) src/hotspot/share/ci/ciEnv.cpp:1614&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#1 0x7fcea3123577 in VMError::report_and_die(int, char const*, char const*, __va_list_tag*, Thread*, unsigned char*, void*, void*, char const*, int, unsigned long) src/hotspot/share/utilities/vmError.cpp:1872&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#2 0x7fcea0c01499 in report_fatal(VMErrorType, char const*, int, char const*, ...) src/hotspot/share/utilities/debug.cpp:214&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#3 0x7fcea09e9d85 in RuntimeStub::new_runtime_stub(char const*, CodeBuffer*, short, int, OopMapSet*, bool, bool) src/hotspot/share/code/codeBlob.cpp:413&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#4 0x7fcea066da1d in Runtime1::generate_blob(BufferBlob*, C1StubId, char const*, bool, StubAssemblerCodeGenClosure*) src/hotspot/share/c1/c1_Runtime1.cpp:233&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#5 0x7fcea066dfb0 in Runtime1::generate_blob_for(BufferBlob*, C1StubId) src/hotspot/share/c1/c1_Runtime1.cpp:262&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#6 0x7fcea066dfb0 in Runtime1::initialize(BufferBlob*) src/hotspot/share/c1/c1_Runtime1.cpp:272&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#7 0x7fcea03d2be1 in Compiler::init_c1_runtime() src/hotspot/share/c1/c1_Compiler.cpp:53&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#8 0x7fcea03d2be1 in Compiler::initialize() src/hotspot/share/c1/c1_Compiler.cpp:74&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#9 0x7fcea0acc0c2 in CompileBroker::init_compiler_runtime() src/hotspot/share/compiler/compileBroker.cpp:1771&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#10 0x7fcea0ad9a3f in CompileBroker::compiler_thread_loop() src/hotspot/share/compiler/compileBroker.cpp:1913&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#11 0x7fcea161264a in JavaThread::thread_main_inner() src/hotspot/share/runtime/javaThread.cpp:759&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#12 0x7fcea2ec739a in Thread::call_run() src/hotspot/share/runtime/thread.cpp:234&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#13 0x7fcea251e1d2 in thread_native_entry src/hotspot/os/linux/os_linux.cpp:858&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#14 0x7fcea7c6c6e9 in start_thread (/lib64/libpthread.so.0+0xa6e9) (BuildId: 1b515766201d47a183932ba0c8c8bd0d9ee8755b)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#15 0x7fcea730f58e in clone (/lib64/libc.so.6+0x11858e) (BuildId: 448a3ddd22596e1adb8fb3dec8921ed5b9d54dc2)</comment>
                            <comment id="14713524" author="roboduke" created="Wed, 16 Oct 2024 04:59:48 -0700"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u-dev/pull/1056&quot;&gt;https://git.openjdk.org/jdk21u-dev/pull/1056&lt;/a&gt;&lt;br/&gt;
Date: 2024-10-16 11:52:08 +0000</comment>
                            <comment id="14713523" author="mbaesken" created="Wed, 16 Oct 2024 04:57:57 -0700"  >jdk21u-dev backport request:&lt;br/&gt;
I would like to have the patch in jdk21u-dev as well, because the issue is present there too. The backport is clean and low risk.</comment>
                            <comment id="14713522" author="mbaesken" created="Wed, 16 Oct 2024 04:57:08 -0700"  >jdk23u backport request:&lt;br/&gt;
I would like to have the patch in jdk23u as well, because the issue is present there too. The backport is clean and low risk.</comment>
                            <comment id="14713521" author="roboduke" created="Wed, 16 Oct 2024 04:57:05 -0700"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk23u/pull/183&quot;&gt;https://git.openjdk.org/jdk23u/pull/183&lt;/a&gt;&lt;br/&gt;
Date: 2024-10-16 11:50:03 +0000</comment>
                            <comment id="14709698" author="dukebot" created="Wed, 2 Oct 2024 01:01:39 -0700"  >Changeset: efe3573b&lt;br/&gt;
Branch: master&lt;br/&gt;
Author:    Matthias Baesken &amp;lt;&lt;a href=&apos;mailto:mbaesken@openjdk.org&apos;&gt;mbaesken@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2024-10-02 07:58:17 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/efe3573b9b4ecec0630fdc1c61c765713a5b68e6&quot;&gt;https://git.openjdk.org/jdk/commit/efe3573b9b4ecec0630fdc1c61c765713a5b68e6&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14709493" author="roboduke" created="Tue, 1 Oct 2024 07:45:57 -0700"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/21288&quot;&gt;https://git.openjdk.org/jdk/pull/21288&lt;/a&gt;&lt;br/&gt;
Date: 2024-10-01 14:37:50 +0000</comment>
                            <comment id="14708947" author="thartmann" created="Sun, 29 Sep 2024 22:53:36 -0700"  >[~mbaesken] Yes, that looks reasonable to me.</comment>
                            <comment id="14708391" author="mbaesken" created="Fri, 27 Sep 2024 05:36:31 -0700"  >&amp;gt; We should probably just bail out in ciEnv::dump_replay_data_helper &lt;br/&gt;
Hi Tobias, so something like this ?&lt;br/&gt;
&lt;br/&gt;
1596  void ciEnv::dump_replay_data_helper(outputStream* out) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;.....&lt;br/&gt;
1616    for (int i = 0; i &amp;lt; objects-&amp;gt;length(); i++) {&lt;br/&gt;
1617      objects-&amp;gt;at(i)-&amp;gt;dump_replay_data(out);&lt;br/&gt;
1618    }&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if (this-&amp;gt;task() != nullptr)  {   // added check&lt;br/&gt;
&lt;br/&gt;
1619    dump_compile_data(out);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
1620    out-&amp;gt;flush();&lt;br/&gt;
&lt;br/&gt;
probably we still want to do out-&amp;gt;flush()  ?</comment>
                            <comment id="14705005" author="thartmann" created="Sun, 15 Sep 2024 22:42:25 -0700"  >So the StartupOutput.java test currently triggers a VM crash during runtime stub creation due to &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8339700&quot; title=&quot;Test compiler/startup/StartupOutput.java intermittent fatal error: Initial size of CodeCache is too small&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8339700&quot;&gt;&lt;strike&gt;JDK-8339700&lt;/strike&gt;&lt;/a&gt; that will lead to error handling attempting to create a replay file. We then assert because task() is null. This is similar to what old &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8194742&quot; title=&quot;Writing replay data crashes: task is NULL.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8194742&quot;&gt;&lt;strike&gt;JDK-8194742&lt;/strike&gt;&lt;/a&gt; fixed but &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8275868&quot; title=&quot;ciReplay: Inlining fails with &amp;quot;unloaded signature classes&amp;quot; due to wrong protection domains&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8275868&quot;&gt;&lt;strike&gt;JDK-8275868&lt;/strike&gt;&lt;/a&gt; added a new task() access. We should probably just bail out in ciEnv::dump_replay_data_helper before we even call dump_compile_data (and can then revert &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8194742&quot; title=&quot;Writing replay data crashes: task is NULL.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8194742&quot;&gt;&lt;strike&gt;JDK-8194742&lt;/strike&gt;&lt;/a&gt;).&lt;br/&gt;
&lt;br/&gt;
ILW = Null pointer dereference in ci-replay code, when trying to create a replay file during error handling for crashing during stub generation, no workaround = MLH = P4</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5141863">JDK-8342526</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5141864">JDK-8342527</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="4949138">JDK-8194742</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5142208">JDK-8342823</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10000" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>CPU</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="19000"><![CDATA[x86_64]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10005" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>OS</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17023"><![CDATA[linux]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i37wtn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17354"><![CDATA[b18]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="208"><![CDATA[compiler]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>