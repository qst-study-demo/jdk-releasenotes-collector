<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Sat Sep 27 10:26:45 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8333890] Fatal error in auto-vectorizer with float16 kernel.</title>
                <link>https://bugs.openjdk.org/browse/JDK-8333890</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>Auto-vectorization of following float16 kernel results into a fatal error.&lt;br/&gt;
&lt;br/&gt;
import java.util.Arrays;&lt;br/&gt;
&lt;br/&gt;
public class float16_mainline_add {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;public static short sum(short a, short b) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;return (short)Float.float16ToFloat(Float.floatToFloat16(Float.float16ToFloat(a) + Float.float16ToFloat(b)));&lt;br/&gt;
&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;public static void micro(short [] r, short [] a, short [] b) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;for (int i = 0; i &amp;lt; a.length; i++) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;r[i] = sum(a[i], b[i]);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;public static void main (String [] args) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;short [] res = new short[1024];&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;short [] src1 = new short[1024];&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;short [] src2 = new short[1024];&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Arrays.fill(src1, (short)1);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Arrays.fill(src2, (short)2);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;for (int i = 0;i &amp;lt; 100000; i++) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;micro(res, src1, src2);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;System.out.println(&amp;quot;[res] &amp;quot; + res[3]);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
# A fatal error has been detected by the Java Runtime Environment:&lt;br/&gt;
#&lt;br/&gt;
#  Internal Error (/home/jatinbha/sandboxes/jdk/jdk/src/hotspot/share/opto/vectornode.cpp:1386), pid=3638113, tid=3638127&lt;br/&gt;
#  Error: assert(bt == T_SHORT) failed&lt;br/&gt;
#&lt;br/&gt;
# JRE version: OpenJDK Runtime Environment (24.0) (slowdebug build 24-internal-adhoc.root.jdk)&lt;br/&gt;
# Java VM: OpenJDK 64-Bit Server VM (slowdebug 24-internal-adhoc.root.jdk, mixed mode, sharing, compressed oops, compressed class ptrs, g1 gc, linux-amd64)&lt;br/&gt;
# Problematic frame:&lt;br/&gt;
# V  [libjvm.so+0x16b29f7]  VectorCastNode::opcode(int, BasicType, bool)+0xcd&lt;br/&gt;
#&lt;br/&gt;
# Core dump will be written. Default location: Core dumps may be processed with &amp;quot;/usr/share/apport/apport %p %s %c %d %P %E&amp;quot; (or dumping to /home/jatinbha/code/java/FP16/core.3638113)&lt;br/&gt;
#&lt;br/&gt;
# An error report file with more information is saved as:&lt;br/&gt;
# /home/jatinbha/code/java/FP16/hs_err_pid3638113.log&lt;br/&gt;
#&lt;br/&gt;
# Compiler replay data is saved as:&lt;br/&gt;
# /home/jatinbha/code/java/FP16/replay_pid3638113.log&lt;br/&gt;
#&lt;br/&gt;
# If you would like to submit a bug report, please visit:&lt;br/&gt;
#   &lt;a href=&quot;https://bugreport.java.com/bugreport/crash.jsp&quot;&gt;https://bugreport.java.com/bugreport/crash.jsp&lt;/a&gt;&lt;br/&gt;
#&lt;br/&gt;
Aborted (core dumped)&lt;br/&gt;
&lt;br/&gt;
Command Line: java -XX:+TraceSuperWord -XX:CompileOnly=float16_mainline_add::micro -Xbatch -XX:-TieredCompilation -cp . float16_mainline_add</description>
                <environment></environment>
        <key id="5131440">JDK-8333890</key>
            <summary>Fatal error in auto-vectorizer with float16 kernel.</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jbhateja">Jatin Bhateja</assignee>
                                    <reporter username="jbhateja">Jatin Bhateja</reporter>
                        <labels>
                            <label>amazon-interest</label>
                            <label>c2</label>
                            <label>c2-superword</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                            <label>oracle-triage-24</label>
                    </labels>
                <created>Mon, 10 Jun 2024 05:49:42 -0700</created>
                <updated>Fri, 4 Apr 2025 01:03:39 -0700</updated>
                            <resolved>Sun, 7 Jul 2024 23:45:57 -0700</resolved>
                                    <version>20</version>
                    <version>21</version>
                    <version>22</version>
                    <version>23</version>
                    <version>24</version>
                                    <fixVersion>24</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="14764420" author="goetz" created="Wed, 26 Mar 2025 12:40:05 -0700"  >Hi [~ssubramaniam]&lt;br/&gt;
I don&amp;#39;t buy that the risk of this change is low. Changing a pattern in C2 can have follow-up effects that make other optimizations possible, that then do untested actions.  This can be hard to detect and can any Java application.&lt;br/&gt;
Nevertheless I think this is an eligible backport.  It will be testet in 24 before it reaches jdk21 in July.</comment>
                            <comment id="14764409" author="roboduke" created="Wed, 26 Mar 2025 11:22:39 -0700"  >[jdk21u-fix-request] Approval Request from Satyen Subramaniam&lt;br/&gt;
for backport. Fixes an assertion failure seen while auto-vectorizing conversion chain involving float16 type by constraining the container type for ConvF2HF IR to short type upfront.&lt;br/&gt;
&lt;br/&gt;
Risk: Low. Tip change was merged in July 2024 and only affects float16 kernel. Further, new test explicitly confirms functionality.&lt;br/&gt;
&lt;br/&gt;
Testing: &lt;br/&gt;
* GHA Sanity Checks&lt;br/&gt;
* Tier 1, 2, and 3 tests locally</comment>
                            <comment id="14764407" author="roboduke" created="Wed, 26 Mar 2025 11:09:21 -0700"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u-dev/pull/1549&quot;&gt;https://git.openjdk.org/jdk21u-dev/pull/1549&lt;/a&gt;&lt;br/&gt;
Date: 2025-03-26 18:00:07 +0000</comment>
                            <comment id="14687646" author="dukebot" created="Sun, 7 Jul 2024 23:45:56 -0700"  >Changeset: 55fd1ed2&lt;br/&gt;
Author:    Jatin Bhateja &amp;lt;&lt;a href=&apos;mailto:jbhateja@openjdk.org&apos;&gt;jbhateja@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2024-07-08 06:42:46 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/55fd1ed228ea3c42aaf92579e5dcb818fe14351d&quot;&gt;https://git.openjdk.org/jdk/commit/55fd1ed228ea3c42aaf92579e5dcb818fe14351d&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14687547" author="roboduke" created="Sat, 6 Jul 2024 11:39:07 -0700"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/20062&quot;&gt;https://git.openjdk.org/jdk/pull/20062&lt;/a&gt;&lt;br/&gt;
Date: 2024-07-06 18:34:54 +0000</comment>
                            <comment id="14680517" author="chagedorn" created="Tue, 11 Jun 2024 02:59:49 -0700"  >ILW = Crash when vectorizing float16ToFloat, rare?, disable compilation of affected method or use -XX:-UseSuperWord = HLM = P3</comment>
                            <comment id="14680516" author="chagedorn" created="Tue, 11 Jun 2024 02:57:08 -0700"  >Starts to fail after introducing auto-vectorization for `Float::float16ToFloat*` (&lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8294588&quot; title=&quot;Auto vectorize half precision floating point conversion APIs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8294588&quot;&gt;&lt;strike&gt;JDK-8294588&lt;/strike&gt;&lt;/a&gt;). Since this is not a new regression, I&amp;#39;m targeting this to JDK 24.</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5154805">JDK-8353653</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10600">
                    <name>Causes</name>
                                            <outwardlinks description="causes">
                                        <issuelink>
            <issuekey id="5133650">JDK-8335860</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5134741">JDK-8336827</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5084419">JDK-8294588</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10000" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>CPU</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17008"><![CDATA[generic]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i36o5v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17334"><![CDATA[b06]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="208"><![CDATA[compiler]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>