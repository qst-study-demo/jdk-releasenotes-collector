<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Sat Sep 27 10:11:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8309667] TLS handshake fails because of ConcurrentModificationException in PKCS12KeyStore.engineGetEntry</title>
                <link>https://bugs.openjdk.org/browse/JDK-8309667</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>Many HTTPClient tests are occasionally failing with the following stack trace:&lt;br/&gt;
javax.net.ssl.SSLHandshakeException: No available authentication scheme&lt;br/&gt;
	at java.base/sun.security.ssl.Alert.createSSLException(Alert.java:130)&lt;br/&gt;
	at java.base/sun.security.ssl.Alert.createSSLException(Alert.java:117)&lt;br/&gt;
	at java.base/sun.security.ssl.TransportContext.fatal(TransportContext.java:365)&lt;br/&gt;
	at java.base/sun.security.ssl.TransportContext.fatal(TransportContext.java:321)&lt;br/&gt;
	at java.base/sun.security.ssl.TransportContext.fatal(TransportContext.java:312)&lt;br/&gt;
	at java.base/sun.security.ssl.CertificateMessage$T13CertificateProducer.onProduceCertificate(CertificateMessage.java:967)&lt;br/&gt;
	at java.base/sun.security.ssl.CertificateMessage$T13CertificateProducer.produce(CertificateMessage.java:956)&lt;br/&gt;
	at java.base/sun.security.ssl.SSLHandshake.produce(SSLHandshake.java:437)&lt;br/&gt;
	at java.base/sun.security.ssl.ClientHello$T13ClientHelloConsumer.goServerHello(ClientHello.java:1245)&lt;br/&gt;
	at java.base/sun.security.ssl.ClientHello$T13ClientHelloConsumer.consume(ClientHello.java:1181)&lt;br/&gt;
	at java.base/sun.security.ssl.ClientHello$ClientHelloConsumer.onClientHello(ClientHello.java:839)&lt;br/&gt;
	at java.base/sun.security.ssl.ClientHello$ClientHelloConsumer.consume(ClientHello.java:800)&lt;br/&gt;
	at java.base/sun.security.ssl.SSLHandshake.consume(SSLHandshake.java:393)&lt;br/&gt;
	at java.base/sun.security.ssl.HandshakeContext.dispatch(HandshakeContext.java:476)&lt;br/&gt;
	at java.base/sun.security.ssl.HandshakeContext.dispatch(HandshakeContext.java:447)&lt;br/&gt;
	at java.base/sun.security.ssl.TransportContext.dispatch(TransportContext.java:201)&lt;br/&gt;
	at java.base/sun.security.ssl.SSLTransport.decode(SSLTransport.java:172)&lt;br/&gt;
	at java.base/sun.security.ssl.SSLSocketImpl.decode(SSLSocketImpl.java:1506)&lt;br/&gt;
	at java.base/sun.security.ssl.SSLSocketImpl.readHandshakeRecord(SSLSocketImpl.java:1421)&lt;br/&gt;
	at java.base/sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:455)&lt;br/&gt;
	at java.base/sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:426)&lt;br/&gt;
	at jdk.httpclient.test.lib.http2.Http2TestServerConnection.handshake(Http2TestServerConnection.java:317)&lt;br/&gt;
	at jdk.httpclient.test.lib.http2.Http2TestServerConnection.&amp;lt;init&amp;gt;(Http2TestServerConnection.java:165)&lt;br/&gt;
	at jdk.httpclient.test.lib.http2.Http2TestServer.createConnection(Http2TestServer.java:389)&lt;br/&gt;
	at jdk.httpclient.test.lib.http2.Http2TestServer$AcceptedConnection.startConnection(Http2TestServer.java:306)&lt;br/&gt;
&lt;br/&gt;
The failing tests include:&lt;br/&gt;
java/net/httpclient/ManyRequests.java&lt;br/&gt;
java/net/httpclient/ManyRequests2.java&lt;br/&gt;
java/net/httpclient/LargeResponseTest.java&lt;br/&gt;
&lt;br/&gt;
Additional logging revealed that the handshake failures were caused by this exception:&lt;br/&gt;
&lt;br/&gt;
java.util.ConcurrentModificationException&lt;br/&gt;
at java.base/java.util.HashMap$HashIterator.nextNode(HashMap.java:1605)&lt;br/&gt;
at java.base/java.util.HashMap$KeyIterator.next(HashMap.java:1628)&lt;br/&gt;
at java.base/java.util.AbstractCollection.addAll(AbstractCollection.java:337)&lt;br/&gt;
at java.base/java.util.HashSet.&amp;lt;init&amp;gt;(HashSet.java:121)&lt;br/&gt;
at java.base/java.security.KeyStore$PrivateKeyEntry.&amp;lt;init&amp;gt;(KeyStore.java:569)&lt;br/&gt;
at java.base/sun.security.pkcs12.PKCS12KeyStore.engineGetEntry(PKCS12KeyStore.java:1338)&lt;br/&gt;
at java.base/sun.security.util.KeyStoreDelegator.engineGetEntry(KeyStoreDelegator.java:174)&lt;br/&gt;
at java.base/java.security.KeyStore.getEntry(KeyStore.java:1576)&lt;br/&gt;
at java.base/sun.security.ssl.X509KeyManagerImpl.getEntry(X509KeyManagerImpl.java:271)&lt;br/&gt;
at java.base/sun.security.ssl.X509KeyManagerImpl.getPrivateKey(X509KeyManagerImpl.java:117)&lt;br/&gt;
at java.base/sun.security.ssl.X509Authentication.createServerPossession(X509Authentication.java:300)&lt;br/&gt;
at java.base/sun.security.ssl.X509Authentication.createPossession(X509Authentication.java:195)&lt;br/&gt;
at java.base/sun.security.ssl.CertificateMessage$T13CertificateProducer.choosePossession(CertificateMessage.java:1056)&lt;br/&gt;
at java.base/sun.security.ssl.CertificateMessage$T13CertificateProducer.onProduceCertificate(CertificateMessage.java:965)&lt;br/&gt;
&lt;br/&gt;
which in turn is caused by PKCS12KeyStore.getAttributes updating the same HashSet over and over again in multiple threads.</description>
                <environment></environment>
        <key id="5102750">JDK-8309667</key>
            <summary>TLS handshake fails because of ConcurrentModificationException in PKCS12KeyStore.engineGetEntry</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="6" iconUrl="https://bugs.openjdk.org/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="weijun">Weijun Wang</assignee>
                                    <reporter username="dfuchs">Daniel Fuchs</reporter>
                        <labels>
                            <label>amazon-interest</label>
                            <label>httpclient</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                            <label>problemlist</label>
                            <label>tier2</label>
                            <label>ur-ci-health</label>
                    </labels>
                <created>Thu, 8 Jun 2023 08:38:14 -0700</created>
                <updated>Wed, 3 Sep 2025 04:49:23 -0700</updated>
                            <resolved>Mon, 2 Oct 2023 14:54:56 -0700</resolved>
                                    <version>8</version>
                    <version>11</version>
                    <version>17</version>
                    <version>21</version>
                    <version>22</version>
                                    <fixVersion>22</fixVersion>
                                    <component>security-libs</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="14771127" author="roboduke" created="Thu, 17 Apr 2025 06:41:48 -0700"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u-dev/pull/1674&quot;&gt;https://git.openjdk.org/jdk21u-dev/pull/1674&lt;/a&gt;&lt;br/&gt;
Date: 2025-04-17 13:35:24 +0000</comment>
                            <comment id="14771123" author="goetz" created="Thu, 17 Apr 2025 06:34:46 -0700"  >Fix request [21u]&lt;br/&gt;
&lt;br/&gt;
I would like to fix this issue in 21. The fix originally was targeted for 21. Also, we see the mentioned tests failing regularly in our CI.&lt;br/&gt;
The fix is rather limited to key construction and well tested in the meantime. Nevertheless it touches delicate security code. &lt;br/&gt;
Clean backport.&lt;br/&gt;
Test passes.  SAP nightly testing passed. SAP nightly testing passed.</comment>
                            <comment id="14615317" author="dukebot" created="Mon, 2 Oct 2023 14:54:55 -0700"  >Changeset: d2e2c4ce&lt;br/&gt;
Author:    Weijun Wang &amp;lt;&lt;a href=&apos;mailto:weijun@openjdk.org&apos;&gt;weijun@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-10-02 21:53:12 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/d2e2c4cef1f15a3fc7f1f619470d23ae6bb37725&quot;&gt;https://git.openjdk.org/jdk/commit/d2e2c4cef1f15a3fc7f1f619470d23ae6bb37725&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14613882" author="roboduke" created="Mon, 25 Sep 2023 12:35:49 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/15909&quot;&gt;https://git.openjdk.org/jdk/pull/15909&lt;/a&gt;&lt;br/&gt;
Date: 2023-09-25 18:12:32 +0000</comment>
                            <comment id="14589784" author="roboduke" created="Thu, 15 Jun 2023 18:58:53 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/14506&quot;&gt;https://git.openjdk.org/jdk/pull/14506&lt;/a&gt;&lt;br/&gt;
Date: 2023-06-16 01:21:57 +0000</comment>
                            <comment id="14589632" author="JIRAUSER19825" created="Thu, 15 Jun 2023 06:54:33 -0700"  >Got it:&lt;br/&gt;
&lt;br/&gt;
java.util.ConcurrentModificationException&lt;br/&gt;
	at java.base/java.util.HashMap$HashIterator.nextNode(HashMap.java:1605)&lt;br/&gt;
	at java.base/java.util.HashMap$KeyIterator.next(HashMap.java:1628)&lt;br/&gt;
	at java.base/java.util.AbstractCollection.addAll(AbstractCollection.java:337)&lt;br/&gt;
	at java.base/java.util.HashSet.&amp;lt;init&amp;gt;(HashSet.java:121)&lt;br/&gt;
	at java.base/java.security.KeyStore$PrivateKeyEntry.&amp;lt;init&amp;gt;(KeyStore.java:569)&lt;br/&gt;
	at java.base/sun.security.pkcs12.PKCS12KeyStore.engineGetEntry(PKCS12KeyStore.java:1338)&lt;br/&gt;
	at java.base/sun.security.util.KeyStoreDelegator.engineGetEntry(KeyStoreDelegator.java:174)&lt;br/&gt;
	at java.base/java.security.KeyStore.getEntry(KeyStore.java:1576)&lt;br/&gt;
	at java.base/sun.security.ssl.X509KeyManagerImpl.getEntry(X509KeyManagerImpl.java:271)&lt;br/&gt;
	at java.base/sun.security.ssl.X509KeyManagerImpl.getPrivateKey(X509KeyManagerImpl.java:117)&lt;br/&gt;
	at java.base/sun.security.ssl.X509Authentication.createServerPossession(X509Authentication.java:300)&lt;br/&gt;
	at java.base/sun.security.ssl.X509Authentication.createPossession(X509Authentication.java:195)&lt;br/&gt;
	at java.base/sun.security.ssl.CertificateMessage$T13CertificateProducer.choosePossession(CertificateMessage.java:1056)&lt;br/&gt;
	at java.base/sun.security.ssl.CertificateMessage$T13CertificateProducer.onProduceCertificate(CertificateMessage.java:965)&lt;br/&gt;
	at java.base/sun.security.ssl.CertificateMessage$T13CertificateProducer.produce(CertificateMessage.java:956)&lt;br/&gt;
	at java.base/sun.security.ssl.SSLHandshake.produce(SSLHandshake.java:437)&lt;br/&gt;
	at java.base/sun.security.ssl.ClientHello$T13ClientHelloConsumer.goServerHello(ClientHello.java:1245)&lt;br/&gt;
	at java.base/sun.security.ssl.ClientHello$T13ClientHelloConsumer.consume(ClientHello.java:1181)&lt;br/&gt;
	at java.base/sun.security.ssl.ClientHello$ClientHelloConsumer.onClientHello(ClientHello.java:839)&lt;br/&gt;
	at java.base/sun.security.ssl.ClientHello$ClientHelloConsumer.consume(ClientHello.java:800)&lt;br/&gt;
	at java.base/sun.security.ssl.SSLHandshake.consume(SSLHandshake.java:393)&lt;br/&gt;
&lt;br/&gt;
(note: line numbers are a little off; I added more logging to catch this issue)</comment>
                            <comment id="14589625" author="JIRAUSER19825" created="Thu, 15 Jun 2023 06:32:32 -0700"  >The failing runs produce messages like the following:&lt;br/&gt;
&lt;br/&gt;
16.0.widgets is not a private key entry&lt;br/&gt;
9.0.widgets is not a private key entry&lt;br/&gt;
&lt;br/&gt;
note that there are many connections using the same SSLContext, and only 1-2 are failing per test run, the rest succeeds just fine.</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5156468">JDK-8355099</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10000">
                    <name>Blocks</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="5105846">JDK-8312384</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10002">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                                        </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                                        </outwardlinks>
                                                                <inwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5103394">JDK-8310209</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i31tx7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17354"><![CDATA[b18]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="195"><![CDATA[java.security]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10100" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Verification</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17000"><![CDATA[Verified]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>