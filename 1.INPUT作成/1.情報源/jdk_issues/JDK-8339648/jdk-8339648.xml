<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Sat Sep 27 09:18:19 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8339648] ZGC: Division by zero in rule_major_allocation_rate</title>
                <link>https://bugs.openjdk.org/browse/JDK-8339648</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>The HS jtreg test gc/stringdedup/TestStringDeduplicationAgeThreshold_ZGenerational&lt;br/&gt;
&lt;br/&gt;
shows this error when running with ubsan enabled :&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;const double current_old_gc_time_per_bytes_freed = double(old_gc_time) / double(reclaimed_per_old_gc);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&lt;br/&gt;
gc/stringdedup/TestStringDeduplicationAgeThreshold_ZGenerational.jtr&lt;br/&gt;
&lt;br/&gt;
src/hotspot/share/gc/z/zDirector.cpp:491:74: runtime error: division by zero&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#0 0x7f09886401d4 in rule_major_allocation_rate src/hotspot/share/gc/z/zDirector.cpp:491&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#1 0x7f09886401d4 in start_gc src/hotspot/share/gc/z/zDirector.cpp:822&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#2 0x7f09886401d4 in ZDirector::run_thread() src/hotspot/share/gc/z/zDirector.cpp:912&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#3 0x7f098c1404e8 in ZThread::run_service() src/hotspot/share/gc/z/zThread.cpp:29&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#4 0x7f09897cac19 in ConcurrentGCThread::run() src/hotspot/share/gc/shared/concurrentGCThread.cpp:48&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#5 0x7f098bb46b0a in Thread::call_run() src/hotspot/share/runtime/thread.cpp:225&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#6 0x7f098b1a9881 in thread_native_entry src/hotspot/os/linux/os_linux.cpp:858&lt;br/&gt;
</description>
                <environment></environment>
        <key id="5138537">JDK-8339648</key>
            <summary>ZGC: Division by zero in rule_major_allocation_rate</summary>
                <type id="7" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14707&amp;avatarType=issuetype">Enhancement</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tschatzl">Thomas Schatzl</assignee>
                                    <reporter username="mbaesken">Matthias Baesken</reporter>
                        <labels>
                            <label>genzgc</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                            <label>jdk23u-fix-SQE-ok</label>
                            <label>jdk23u-fix-request</label>
                            <label>jdk23u-fix-yes</label>
                            <label>ubsan</label>
                    </labels>
                <created>Fri, 6 Sep 2024 02:39:54 -0700</created>
                <updated>Mon, 18 Nov 2024 06:59:21 -0800</updated>
                            <resolved>Tue, 17 Sep 2024 05:02:47 -0700</resolved>
                                    <version>21</version>
                    <version>23</version>
                    <version>24</version>
                                    <fixVersion>24</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14715820" author="mbaesken" created="Tue, 22 Oct 2024 07:43:57 -0700"  >looks like this division can also run into the &amp;quot;division by zero&amp;quot; issue  (seen in compiler/uncommontrap/TestDeoptOOM.java#ZGenerational  jtreg test)  :&lt;br/&gt;
&lt;a href=&quot;https://github.com/openjdk/jdk/blob/master/src/hotspot/share/gc/z/zDirector.cpp#L490&quot;&gt;https://github.com/openjdk/jdk/blob/master/src/hotspot/share/gc/z/zDirector.cpp#L490&lt;/a&gt;&lt;br/&gt;
const double current_young_gc_time_per_bytes_freed = double(young_gc_time) / double(reclaimed_per_young_gc);&lt;br/&gt;
&lt;br/&gt;
src/hotspot/share/gc/z/zDirector.cpp:490:78: runtime error: division by zero&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#0 0x7f2454cec043 in rule_major_allocation_rate src/hotspot/share/gc/z/zDirector.cpp:490&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#1 0x7f2454cec043 in start_gc src/hotspot/share/gc/z/zDirector.cpp:836&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#2 0x7f2454cec043 in ZDirector::run_thread() src/hotspot/share/gc/z/zDirector.cpp:926&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#3 0x7f245886f2b8 in ZThread::run_service() src/hotspot/share/gc/z/zThread.cpp:29&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#4 0x7f2455ed7809 in ConcurrentGCThread::run() src/hotspot/share/gc/shared/concurrentGCThread.cpp:48&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#5 0x7f245826c39a in Thread::call_run() src/hotspot/share/runtime/thread.cpp:234&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#6 0x7f24578c31d2 in thread_native_entry src/hotspot/os/linux/os_linux.cpp:858</comment>
                            <comment id="14710352" author="mbaesken" created="Fri, 4 Oct 2024 06:30:01 -0700"  >jdk21u-dev backport request&lt;br/&gt;
I would like to backport the patch to jdk21u-dev, because the issue is present there too. The backport is clean and low risk.</comment>
                            <comment id="14710350" author="mbaesken" created="Fri, 4 Oct 2024 06:29:37 -0700"  >jdk23u backport request&lt;br/&gt;
I would like to backport the patch to jdk23u, because the issue is present there too. The backport is clean and low risk.</comment>
                            <comment id="14710327" author="roboduke" created="Fri, 4 Oct 2024 05:50:56 -0700"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk23u/pull/132&quot;&gt;https://git.openjdk.org/jdk23u/pull/132&lt;/a&gt;&lt;br/&gt;
Date: 2024-10-04 12:44:50 +0000</comment>
                            <comment id="14710326" author="roboduke" created="Fri, 4 Oct 2024 05:50:52 -0700"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u-dev/pull/1022&quot;&gt;https://git.openjdk.org/jdk21u-dev/pull/1022&lt;/a&gt;&lt;br/&gt;
Date: 2024-10-04 12:44:28 +0000</comment>
                            <comment id="14705559" author="dukebot" created="Tue, 17 Sep 2024 05:02:45 -0700"  >Changeset: 80db6e71&lt;br/&gt;
Branch: master&lt;br/&gt;
Author:    Matthias Baesken &amp;lt;&lt;a href=&apos;mailto:mbaesken@openjdk.org&apos;&gt;mbaesken@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2024-09-17 11:58:58 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/80db6e71b092867212147bd369a9fda65dbd4b70&quot;&gt;https://git.openjdk.org/jdk/commit/80db6e71b092867212147bd369a9fda65dbd4b70&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14704744" author="mbaesken" created="Fri, 13 Sep 2024 03:26:43 -0700"  >&amp;gt; So it looks like this is an ubsan bug (and this change a workaround): it should not fail on a division by zero in this case which is defined +infinity&lt;br/&gt;
&lt;br/&gt;
Seems ubsan is a bit too cautious with these division by zero findings.&lt;br/&gt;
There is also a discussion around the topic here&lt;br/&gt;
&lt;a href=&quot;https://github.com/google/oss-fuzz/issues/10564&quot;&gt;https://github.com/google/oss-fuzz/issues/10564&lt;/a&gt;&lt;br/&gt;
We could switch the (float) division by zero ubsan - checks off in configure, if it is our common understanding that on the compilers/platforms OpenJDK supports we can live without the check .</comment>
                            <comment id="14704727" author="tschatzl" created="Fri, 13 Sep 2024 02:39:30 -0700"  >So it looks like this is an ubsan bug (and this change a workaround): it should not fail on a division by zero in this case which is defined +infinity (and the comparisons later also seem correct).&lt;br/&gt;
I.e. afaiu if the C runtime supports IEC 559:1989 (and actually the current standard ISO/IEC 60559:2020), which seems to be true (std::numeric_limits&amp;lt;double&amp;gt;::is_iec559 is true) float division by zero is defined.&lt;br/&gt;
&lt;br/&gt;
Since this looks like an ubsan workaround, changing this to an enhancement.</comment>
                            <comment id="14703227" author="roboduke" created="Fri, 6 Sep 2024 03:32:11 -0700"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/20888&quot;&gt;https://git.openjdk.org/jdk/pull/20888&lt;/a&gt;&lt;br/&gt;
Date: 2024-09-06 10:26:19 +0000</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5140942">JDK-8341720</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5141054">JDK-8341823</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5141839">JDK-8342503</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5144145">JDK-8344414</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5134846">JDK-8336911</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10000" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>CPU</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17008"><![CDATA[generic]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10005" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>OS</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17010"><![CDATA[generic]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i37tnn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17312"><![CDATA[b16]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="209"><![CDATA[gc]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>