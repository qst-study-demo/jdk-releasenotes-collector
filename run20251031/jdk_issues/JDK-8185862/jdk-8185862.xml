<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Fri Sep 26 00:12:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8185862] AWT Assertion Failure in ::GetDIBits(hBMDC, hBM, 0, 1, 0, gpBitmapInfo, 0) &apos;awt_Win32GraphicsDevice.cpp&apos;, at line 185</title>
                <link>https://bugs.openjdk.org/browse/JDK-8185862</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>The test failed on Windows with following assertion:&lt;br/&gt;
&lt;br/&gt;
[glue.process.err] [stress.process.err] *********************&lt;br/&gt;
[glue.process.err] [stress.process.err] AWT Assertion Failure&lt;br/&gt;
[glue.process.err] [stress.process.err] *********************&lt;br/&gt;
[glue.process.err] [stress.process.err] ::GetDIBits(hBMDC, hBM, 0, 1, 0, gpBitmapInfo, 0)&lt;br/&gt;
[glue.process.err] [stress.process.err] File &amp;#39;awt_Win32GraphicsDevice.cpp&amp;#39;, at line 185&lt;br/&gt;
[glue.process.err] [stress.process.err] GetLastError() is 57 : The parameter is incorrect.&lt;br/&gt;
[glue.process.err] [stress.process.err] &lt;br/&gt;
[glue.process.err] [stress.process.err] Do you want to break into the debugger?&lt;br/&gt;
[glue.process.err] [stress.process.err] *********************&lt;br/&gt;
[glue.process.err] [stress.process.err] *********************&lt;br/&gt;
[glue.process.err] [stress.process.err] AWT Assertion Failure&lt;br/&gt;
[glue.process.err] [stress.process.err] *********************&lt;br/&gt;
[glue.process.err] [stress.process.err] ::DeleteObject(hBM)&lt;br/&gt;
[glue.process.err] [stress.process.err] File &amp;#39;awt_Win32GraphicsDevice.cpp&amp;#39;, at line 298&lt;br/&gt;
[glue.process.err] [stress.process.err] GetLastError() is 57 : The parameter is incorrect.&lt;br/&gt;
[glue.process.err] [stress.process.err] &lt;br/&gt;
[glue.process.err] [stress.process.err] Do you want to break into the debugger?&lt;br/&gt;
[glue.process.err] [stress.process.err] *********************&lt;br/&gt;
[glue.process.err] [stress.process.err] *********************&lt;br/&gt;
[glue.process.err] [stress.process.err] AWT Assertion Failure&lt;br/&gt;
[glue.process.err] [stress.process.err] *********************&lt;br/&gt;
[glue.process.err] [stress.process.err] ::DeleteDC(hBMDC)&lt;br/&gt;
[glue.process.err] [stress.process.err] File &amp;#39;awt_Win32GraphicsDevice.cpp&amp;#39;, at line 299&lt;br/&gt;
[glue.process.err] [stress.process.err] GetLastError() is 6 : The handle is invalid.&lt;br/&gt;
[glue.process.err] [stress.process.err] </description>
                <environment></environment>
        <key id="4937217">JDK-8185862</key>
            <summary>AWT Assertion Failure in ::GetDIBits(hBMDC, hBM, 0, 1, 0, gpBitmapInfo, 0) &apos;awt_Win32GraphicsDevice.cpp&apos;, at line 185</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://bugs.openjdk.org/images/jbsImages/p3.png">P3</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="clanger">Christoph Langer</assignee>
                                    <reporter username="lmesnik">Leonid Mesnik</reporter>
                        <labels>
                            <label>intermittent</label>
                            <label>jdk17u-fix-request</label>
                            <label>jdk17u-fix-yes</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                            <label>jdk22u-fix-SQE-ok-next</label>
                            <label>jdk22u-fix-request</label>
                            <label>jdk22u-fix-yes</label>
                    </labels>
                <created>Fri, 4 Aug 2017 11:27:21 -0700</created>
                <updated>Tue, 10 Jun 2025 03:14:20 -0700</updated>
                            <resolved>Wed, 13 Mar 2024 14:11:25 -0700</resolved>
                                    <version>8</version>
                    <version>11</version>
                    <version>17</version>
                    <version>21</version>
                    <version>22</version>
                    <version>23</version>
                                    <fixVersion>23</fixVersion>
                                    <component>client-libs</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>12</watches>
                                                                                                                <comments>
                            <comment id="14744035" author="clanger" created="Sun, 26 Jan 2025 00:23:12 -0800"  >We should backout this change in JDK 21 and below, since the change in functionality causes so much trouble. I will take car of that. For head JDK I will take a closer look whether we can improve the handling and fix the issues with explicitly setting -Djava.awt.headless=false.</comment>
                            <comment id="14708724" author="tongwan" created="Sat, 28 Sep 2024 21:55:59 -0700"  >Additional information:&lt;br/&gt;
We can live with the idea of &amp;quot;-Djava.awt.headless=false&amp;quot; as an alternative to completely reverting the changes of &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8185862&quot; title=&quot;AWT Assertion Failure in ::GetDIBits(hBMDC, hBM, 0, 1, 0, gpBitmapInfo, 0) &amp;#39;awt_Win32GraphicsDevice.cpp&amp;#39;, at line 185&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8185862&quot;&gt;&lt;strike&gt;JDK-8185862&lt;/strike&gt;&lt;/a&gt;. However we would like to argue for a complete reversal because:&lt;br/&gt;
&lt;br/&gt;
Several of our customers reported regression problems during creation and execution of automated tests in two areas (using Java 17.0.12).&lt;br/&gt;
&lt;br/&gt;
1. When interactively working with a Swing/AWT application on a remote machine using Windows RDP, the application crashes as soon as the RDP session is temporarily closed.&lt;br/&gt;
&lt;br/&gt;
2. When running tests on machines where the new algorithm in Devices.cpp discards all enumerated displays in &amp;quot;IsValidMonitor&amp;quot;, new HeadlessExceptions are thrown, whereas the test ran before without any issue.&lt;br/&gt;
&lt;br/&gt;
We were never able to reproduce the issues ourselves despite trying on various real and virtual machines with varying graphics and RDP settings. Two customers however could reproduce it reliably and demonstrate it. One sent us a video capture of the following:&lt;br/&gt;
&lt;br/&gt;
- RDP into the target machine&lt;br/&gt;
- Start an arbitrary Swing application with Eclipse Adoptium 7.0.12 JDK&lt;br/&gt;
- Close RDP and reopen it&lt;br/&gt;
- The application has crashed.&lt;br/&gt;
&lt;br/&gt;
Adding &amp;quot;-Djava.awt.headless=false&amp;quot; as a workaound would help us and others that are aware of the issue and willing to add the property. However, all unchanged Swing applications running on Java versions with &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8185862&quot; title=&quot;AWT Assertion Failure in ::GetDIBits(hBMDC, hBM, 0, 1, 0, gpBitmapInfo, 0) &amp;#39;awt_Win32GraphicsDevice.cpp&amp;#39;, at line 185&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8185862&quot;&gt;&lt;strike&gt;JDK-8185862&lt;/strike&gt;&lt;/a&gt; included might simply crash for some users when using RDP.&lt;br/&gt;
&lt;br/&gt;
Currently, the only &amp;quot;workaround&amp;quot; is to stay with Java 17.0.11 on Windows, which of course is not a long term solution, so we are desperately waiting for a bugfix for this regression.&lt;br/&gt;
</comment>
                            <comment id="14661611" author="clanger" created="Sun, 31 Mar 2024 03:59:55 -0700"  >Fix request (21u, 17u)&lt;br/&gt;
Fixes an issue (e.g. assertions) for Windows headless environments by properly detecting this and setting headless mode. Risk is moderate since Windows headless environment seems to be rare anyway. Tested GHA and SAP test system.</comment>
                            <comment id="14660134" author="roboduke" created="Mon, 25 Mar 2024 09:22:13 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk17u-dev/pull/2328&quot;&gt;https://git.openjdk.org/jdk17u-dev/pull/2328&lt;/a&gt;&lt;br/&gt;
Date: 2024-03-25 16:16:12 +0000</comment>
                            <comment id="14660133" author="roboduke" created="Mon, 25 Mar 2024 09:17:45 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u-dev/pull/407&quot;&gt;https://git.openjdk.org/jdk21u-dev/pull/407&lt;/a&gt;&lt;br/&gt;
Date: 2024-03-25 16:13:01 +0000</comment>
                            <comment id="14659110" author="roboduke" created="Wed, 20 Mar 2024 13:46:15 -0700"  >[jdk22u-fix-request] Approval Request from Christoph Langer&lt;br/&gt;
Fixes an issue (e.g. assertions) for Windows headless environments by properly detecting this and setting headless mode. Risk is moderate since Windows headless environment seems to be rare anyway. Tested GHA and SAP test system.</comment>
                            <comment id="14658418" author="roboduke" created="Tue, 19 Mar 2024 00:11:23 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk22u/pull/105&quot;&gt;https://git.openjdk.org/jdk22u/pull/105&lt;/a&gt;&lt;br/&gt;
Date: 2024-03-19 07:05:53 +0000</comment>
                            <comment id="14657257" author="dukebot" created="Wed, 13 Mar 2024 14:11:24 -0700"  >Changeset: 1ad3ebcf&lt;br/&gt;
Author:    Christoph Langer &amp;lt;&lt;a href=&apos;mailto:clanger@openjdk.org&apos;&gt;clanger@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2024-03-13 21:09:00 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/1ad3ebcf11834ec1d119ee95c858d98fb7bc6e68&quot;&gt;https://git.openjdk.org/jdk/commit/1ad3ebcf11834ec1d119ee95c858d98fb7bc6e68&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14644367" author="roboduke" created="Mon, 29 Jan 2024 06:31:28 -0800"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/17614&quot;&gt;https://git.openjdk.org/jdk/pull/17614&lt;/a&gt;&lt;br/&gt;
Date: 2024-01-29 14:24:43 +0000</comment>
                            <comment id="14637180" author="aivanov" created="Wed, 3 Jan 2024 08:59:13 -0800"  >This bug is an exact duplicate of &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8320405&quot; title=&quot;[Windows Server 2016] java/awt/image/MultiResolutionImage/MultiResolutionImageObserverTest.java shows issues in awt_Win32GraphicsDevice.cpp&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8320405&quot;&gt;&lt;strike&gt;JDK-8320405&lt;/strike&gt;&lt;/a&gt; which has an open PR: &lt;a href=&quot;https://github.com/openjdk/jdk/pull/17197&quot;&gt;https://github.com/openjdk/jdk/pull/17197&lt;/a&gt;</comment>
                            <comment id="14614600" author="JIRAUSER20002" created="Thu, 28 Sep 2023 01:28:14 -0700"  >This rerefence from Micrsoft should help takling the issue - &lt;a href=&quot;https://learn.microsoft.com/en-us/windows/win32/wer/wer-settings?redirectedfrom=MSDN&quot;&gt;https://learn.microsoft.com/en-us/windows/win32/wer/wer-settings?redirectedfrom=MSDN&lt;/a&gt;&lt;br/&gt;
From [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\Windows Error Reporting] registry we should try setting&lt;br/&gt;
DontShowUI=1&lt;br/&gt;
ForceQueue=1&lt;br/&gt;
and maybe&lt;br/&gt;
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\Windows Error Reporting\Consent]&lt;br/&gt;
&amp;quot;DefaultConsent&amp;quot;=dword:00000001&lt;br/&gt;
&lt;br/&gt;
for all the servers running the tests.</comment>
                            <comment id="14614392" author="aivanov" created="Wed, 27 Sep 2023 08:15:19 -0700"  >&amp;gt; I believe Windows can be configured in a way that asserts result in&lt;br/&gt;
&amp;gt; a process termination instead of &amp;quot;Do you want to break into the debugger?&amp;quot;&lt;br/&gt;
&amp;gt; popups time-outing after 8 minutes. -&amp;gt; big time saver.&lt;br/&gt;
&lt;br/&gt;
If no debugger is installed, it should just terminate the process.&lt;br/&gt;
&lt;br/&gt;
There could be an option to suppress prompting to debug.</comment>
                            <comment id="14554286" author="JIRAUSER20002" created="Wed, 25 Jan 2023 02:13:35 -0800"  >Happened for JDK8u as well. Attached log file.&lt;br/&gt;
&lt;br/&gt;
1. Do we need to change the test framework so that I can check whether the environment is good enough? Is there a GDI device, or we are running in console-mode.&lt;br/&gt;
2. The test process is hitting an assert. I believe Windows can be configured in a way that asserts result in a process termination instead of &amp;quot;Do you want to break into the debugger?&amp;quot; popups time-outing after 8 minutes. -&amp;gt; big time saver.</comment>
                            <comment id="14430760" author="serb" created="Mon, 28 Jun 2021 15:35:44 -0700"  >When this bug will be fixed the change pushed for &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8269529&quot; title=&quot;javax/swing/reliability/HangDuringStaticInitialization.java fails in Windows debug build&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8269529&quot;&gt;&lt;strike&gt;JDK-8269529&lt;/strike&gt;&lt;/a&gt; need to be rollback.</comment>
                            <comment id="14281989" author="lmesnik" created="Thu, 1 Aug 2019 16:21:18 -0700"  >Default mode is used.</comment>
                            <comment id="14281976" author="serb" created="Thu, 1 Aug 2019 14:40:09 -0700"  >This test is executed in the headless mode(-Djava.awt.headless=true) or in the default headful mode?</comment>
                            <comment id="14107161" author="lmesnik" created="Fri, 4 Aug 2017 11:28:25 -0700"  >Here is the link to failure:&lt;br/&gt;
&lt;a href=&quot;http://jpg-infra-services-stage.us.oracle.com:31109/mdash/jobs/lmesnik-jdk10-ks-20170804-0459-7969/tasks/eGybtBARp/results&quot;&gt;http://jpg-infra-services-stage.us.oracle.com:31109/mdash/jobs/lmesnik-jdk10-ks-20170804-0459-7969/tasks/eGybtBARp/results&lt;/a&gt;&lt;br/&gt;
and jtreg log&lt;br/&gt;
&lt;a href=&quot;http://jpg-infra-services-stage.us.oracle.com:31131/trixie/api/v1/results/2f14e7a5-fd71-4efe-af4f-ae66a27bb9f2/log&quot;&gt;http://jpg-infra-services-stage.us.oracle.com:31131/trixie/api/v1/results/2f14e7a5-fd71-4efe-af4f-ae66a27bb9f2/log&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Unfortunately test is still in development and there is no way to reproduce failure until it is integrated.</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5125131">JDK-8328949</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5126103">JDK-8329602</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5126664">JDK-8330082</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10600">
                    <name>Causes</name>
                                            <outwardlinks description="causes">
                                        <issuelink>
            <issuekey id="5134749">JDK-8336862</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5140282">JDK-8341294</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5140428">JDK-8341382</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5149091">JDK-8348625</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10002">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                                        </outwardlinks>
                                                                <inwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="5115070">JDK-8320405</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5048196">JDK-8266129</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5052873">JDK-8269529</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5118840">JDK-8323664</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5139837">JDK-8340992</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="102402" name="log" size="21331" author="ibereziuk" created="Wed, 25 Jan 2023 02:06:28 -0800"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10005" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>OS</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17005"><![CDATA[windows]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i29ytf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17407"><![CDATA[b14]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="196"><![CDATA[java.awt]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>