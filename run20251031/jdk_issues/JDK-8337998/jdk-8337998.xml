<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Sat Sep 27 10:29:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8337998] CompletionFailure in getEnclosingType attaching type annotations</title>
                <link>https://bugs.openjdk.org/browse/JDK-8337998</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>The following example shows a crash in javac while attaching type annotations read from a class file.&lt;br/&gt;
&lt;br/&gt;
To locate type annotations on class types, javac uses getEnclosingType() to look up enclosing types to interpret type_path_kind=1 entries. The location on inner classes is expressed &amp;#39;backwards&amp;#39;, where an empty path locates the on the &amp;#39;outermost part of the type for which a type annotation is admissible&amp;#39;, and each type_path_kind=1 steps into a nested type.&lt;br/&gt;
&lt;br/&gt;
For this specific issue, there is enough information in the InnerClasses attribute to determine whether the class type has an enclosing type, so this symbol completion could likely be avoided for classes without an enclosing type.&lt;br/&gt;
&lt;br/&gt;
In general, completion failures in this code should not trigger a crash. There are a few possible options: report a non-crash error, report a warning (which could be configurable with -Xlint:classfile or another option), or try to silently tolerate the missing information.&lt;br/&gt;
&lt;br/&gt;
=== ./B.java&lt;br/&gt;
import static java.lang.annotation.ElementType.TYPE_USE;&lt;br/&gt;
&lt;br/&gt;
import java.lang.annotation.Target;&lt;br/&gt;
&lt;br/&gt;
class B {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;private @Anno A&amp;lt;String&amp;gt; a;&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;@Target(TYPE_USE)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;@interface Anno {}&lt;br/&gt;
}&lt;br/&gt;
=== ./C.java&lt;br/&gt;
class C {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;B b;&lt;br/&gt;
}&lt;br/&gt;
=== ./A.java&lt;br/&gt;
class A&amp;lt;E&amp;gt; {}&lt;br/&gt;
&lt;br/&gt;
$ javac -fullversion&lt;br/&gt;
javac full version &amp;quot;24-ea+9-972&amp;quot;&lt;br/&gt;
$ javac A.java  B.java  C.java&lt;br/&gt;
$ rm A.clas&lt;br/&gt;
$ javac C.java -sourcepath : -XDdev&lt;br/&gt;
An exception has occurred in the compiler (24-ea). Please file a bug against the Java compiler via the Java bug reporting page (&lt;a href=&quot;https://bugreport.java.com&quot;&gt;https://bugreport.java.com&lt;/a&gt;) after checking the Bug Database (&lt;a href=&quot;https://bugs.java.com&quot;&gt;https://bugs.java.com&lt;/a&gt;) for duplicates. Include your program, the following diagnostic, and the parameters passed to the Java compiler in your report. Thank you.&lt;br/&gt;
com.sun.tools.javac.code.Symbol$CompletionFailure: class file for A not found&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at jdk.compiler/com.sun.tools.javac.code.ClassFinder.newCompletionFailure(ClassFinder.java:420)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at jdk.compiler/com.sun.tools.javac.code.ClassFinder.classFileNotFound(ClassFinder.java:407)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at jdk.compiler/com.sun.tools.javac.code.ClassFinder.fillIn(ClassFinder.java:402)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at jdk.compiler/com.sun.tools.javac.code.ClassFinder.complete(ClassFinder.java:302)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at jdk.compiler/com.sun.tools.javac.code.Symbol.complete(Symbol.java:703)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at jdk.compiler/com.sun.tools.javac.code.Symbol$ClassSymbol.complete(Symbol.java:1471)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at jdk.compiler/com.sun.tools.javac.code.Symbol.apiComplete(Symbol.java:709)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at jdk.compiler/com.sun.tools.javac.jvm.ClassReader$1.getEnclosingType(ClassReader.java:612)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at jdk.compiler/com.sun.tools.javac.jvm.ClassReader$TypeAnnotationLocator.visitClassType(ClassReader.java:2525)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at jdk.compiler/com.sun.tools.javac.jvm.ClassReader$TypeAnnotationLocator.visitClassType(ClassReader.java:2501)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at jdk.compiler/com.sun.tools.javac.code.Type$ClassType.accept(Type.java:1053)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at jdk.compiler/com.sun.tools.javac.code.Types$DefaultTypeVisitor.visit(Types.java:4920)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at jdk.compiler/com.sun.tools.javac.jvm.ClassReader$TypeAnnotationSymbolVisitor.addTypeAnnotations(ClassReader.java:2466)</description>
                <environment></environment>
        <key id="5136349">JDK-8337998</key>
            <summary>CompletionFailure in getEnclosingType attaching type annotations</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://bugs.openjdk.org/images/jbsImages/p3.png">P3</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cushon">Liam Miller-Cushon</assignee>
                                    <reporter username="cushon">Liam Miller-Cushon</reporter>
                        <labels>
                            <label>javac-crash</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                            <label>jdk23u-fix-SQE-ok-next</label>
                            <label>jdk23u-fix-request</label>
                            <label>jdk23u-fix-yes</label>
                            <label>type-annotations</label>
                    </labels>
                <created>Wed, 7 Aug 2024 08:56:34 -0700</created>
                <updated>Fri, 18 Apr 2025 12:44:18 -0700</updated>
                            <resolved>Tue, 13 Aug 2024 08:07:39 -0700</resolved>
                                                    <fixVersion>24</fixVersion>
                                    <component>tools</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14771432" author="sgehwolf" created="Fri, 18 Apr 2025 05:49:56 -0700"  >OpenJDK 21u maintainer comment:&lt;br/&gt;
&lt;br/&gt;
Note that &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8341779&quot; title=&quot;[REDO BACKPORT] type annotations are not visible to javac plugins across compilation boundaries (JDK-8225377)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8341779&quot;&gt;&lt;strike&gt;JDK-8341779&lt;/strike&gt;&lt;/a&gt; (new in 21.0.8) is a redo of the 21 backport of &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8225377&quot; title=&quot;type annotations are not visible to javac plugins across compilation boundaries&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8225377&quot;&gt;&lt;strike&gt;JDK-8225377&lt;/strike&gt;&lt;/a&gt; which got backed out in 21.0.2.</comment>
                            <comment id="14764748" author="roboduke" created="Thu, 27 Mar 2025 09:27:14 -0700"  >[jdk21u-fix-request] Approval Request from Liam Miller-Cushon&lt;br/&gt;
for backport. This is a follow-on fix related to the backport of &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8341779&quot; title=&quot;[REDO BACKPORT] type annotations are not visible to javac plugins across compilation boundaries (JDK-8225377)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8341779&quot;&gt;&lt;strike&gt;JDK-8341779&lt;/strike&gt;&lt;/a&gt; (allow accessing type-use annotations on types loaded from class files), if that backport is approved this change should also be backported. Tested with tier1.</comment>
                            <comment id="14733024" author="roboduke" created="Tue, 17 Dec 2024 14:41:27 -0800"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u-dev/pull/1253&quot;&gt;https://git.openjdk.org/jdk21u-dev/pull/1253&lt;/a&gt;&lt;br/&gt;
Date: 2024-12-17 22:35:00 +0000</comment>
                            <comment id="14697985" author="roboduke" created="Tue, 13 Aug 2024 10:36:12 -0700"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk23u/pull/68&quot;&gt;https://git.openjdk.org/jdk23u/pull/68&lt;/a&gt;&lt;br/&gt;
Date: 2024-08-13 17:29:20 +0000</comment>
                            <comment id="14697983" author="roboduke" created="Tue, 13 Aug 2024 10:33:16 -0700"  >[jdk23u-fix-request] Approval Request from Liam Miller-Cushon&lt;br/&gt;
This change fixes a javac crash when classes are missing from the classpath. The fix causes javac to instead report a non-crash error diagnostic. The patch applies cleanly, and langtools tier1 passes.</comment>
                            <comment id="14697935" author="dukebot" created="Tue, 13 Aug 2024 08:07:37 -0700"  >Changeset: 9e282e5c&lt;br/&gt;
Branch: master&lt;br/&gt;
Author:    Liam Miller-Cushon &amp;lt;&lt;a href=&apos;mailto:cushon@openjdk.org&apos;&gt;cushon@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2024-08-13 15:05:49 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/9e282e5c966a9c065de8b901b7d30bb5c9ccf243&quot;&gt;https://git.openjdk.org/jdk/commit/9e282e5c966a9c065de8b901b7d30bb5c9ccf243&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14696789" author="roboduke" created="Wed, 7 Aug 2024 15:17:52 -0700"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/20495&quot;&gt;https://git.openjdk.org/jdk/pull/20495&lt;/a&gt;&lt;br/&gt;
Date: 2024-08-07 15:59:58 +0000</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5141440">JDK-8342159</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5156418">JDK-8355057</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5141006">JDK-8341779</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="4992387">JDK-8225377</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i37hcr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17311"><![CDATA[b11]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="212"><![CDATA[javac]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>