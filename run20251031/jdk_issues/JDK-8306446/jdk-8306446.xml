<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Sat Sep 27 08:52:59 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8306446] java/lang/management/ThreadMXBean/Locks.java transient failures</title>
                <link>https://bugs.openjdk.org/browse/JDK-8306446</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>The java/lang/management/ThreadMXBean/Locks.java test seems to expect all threads returned by java.lang.management.ThreadMXBean#getAllThreadIds to still be alive in a subsequent call to java.lang.management.ThreadMXBean#getThreadInfo(long). Running the test on GraalVM sometimes fails with:&lt;br/&gt;
&lt;br/&gt;
STDOUT:&lt;br/&gt;
LockBThread about to block on OBJC&lt;br/&gt;
LockAThread about to block on OBJB&lt;br/&gt;
Stack dump : Thread -&amp;gt; LockBThread&lt;br/&gt;
	java.base/java.util.concurrent.Phaser.internalAwaitAdvance(Phaser.java:1063)&lt;br/&gt;
	java.base/java.util.concurrent.Phaser.arriveAndAwaitAdvance(Phaser.java:685)&lt;br/&gt;
	Locks$LockBThread.run(Locks.java:196)&lt;br/&gt;
&lt;br/&gt;
STDERR:&lt;br/&gt;
java.lang.NullPointerException: Cannot invoke &amp;quot;java.lang.management.ThreadInfo.getLockName()&amp;quot; because &amp;quot;&amp;lt;local7&amp;gt;&amp;quot; is null&lt;br/&gt;
	at Locks.doCheck(Locks.java:437)&lt;br/&gt;
	at Locks.findThreadsBlockedOn(Locks.java:425)&lt;br/&gt;
	at Locks.main(Locks.java:374)&lt;br/&gt;
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)&lt;br/&gt;
	at java.base/java.lang.reflect.Method.invoke(Method.java:578)&lt;br/&gt;
	at com.sun.javatest.regtest.agent.MainWrapper$MainThread.run(MainWrapper.java:125)&lt;br/&gt;
	at java.base/java.lang.Thread.run(Thread.java:1623)&lt;br/&gt;
</description>
                <environment></environment>
        <key id="5098897">JDK-8306446</key>
            <summary>java/lang/management/ThreadMXBean/Locks.java transient failures</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kevinw">Kevin Walls</assignee>
                                    <reporter username="dnsimon">Douglas Simon</reporter>
                        <labels>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                            <label>noreg-self</label>
                    </labels>
                <created>Wed, 19 Apr 2023 05:49:14 -0700</created>
                <updated>Wed, 7 May 2025 20:08:35 -0700</updated>
                            <resolved>Fri, 28 Jul 2023 03:05:18 -0700</resolved>
                                                    <fixVersion>22</fixVersion>
                                    <component>core-svc</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="14719099" author="roboduke" created="Mon, 4 Nov 2024 22:38:13 -0800"  >[jdk21u-fix-request] Approval Request from sendaoYan&lt;br/&gt;
Clean backport from jdk22 to jdk21u-dev, to make this test run passed with TEST_THREAD_FACTORY=Virtual. Before apply this backport patch, this test run fails with TEST_THREAD_FACTORY=Virtual, after apply this backport patch, this test run pass with TEST_THREAD_FACTORY=Virtual. The change has been verified locally on linux-x64 and linux-aarch64. Test-fix only, no risk.</comment>
                            <comment id="14719068" author="roboduke" created="Mon, 4 Nov 2024 20:21:59 -0800"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u-dev/pull/1125&quot;&gt;https://git.openjdk.org/jdk21u-dev/pull/1125&lt;/a&gt;&lt;br/&gt;
Date: 2024-11-05 04:18:01 +0000</comment>
                            <comment id="14599900" author="dukebot" created="Fri, 28 Jul 2023 03:05:17 -0700"  >Changeset: 4ae5a3e3&lt;br/&gt;
Author:    Kevin Walls &amp;lt;&lt;a href=&apos;mailto:kevinw@openjdk.org&apos;&gt;kevinw@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2023-07-28 09:44:04 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/4ae5a3e39b681bfd001df1483d8a6d1fce0bc7f8&quot;&gt;https://git.openjdk.org/jdk/commit/4ae5a3e39b681bfd001df1483d8a6d1fce0bc7f8&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14590334" author="roboduke" created="Mon, 19 Jun 2023 12:07:31 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/14501&quot;&gt;https://git.openjdk.org/jdk/pull/14501&lt;/a&gt;&lt;br/&gt;
Date: 2023-06-15 20:34:53 +0000</comment>
                            <comment id="14589276" author="kevinw" created="Wed, 14 Jun 2023 05:07:13 -0700"  >Yes, this needs to protect itself against disappearing threads.&lt;br/&gt;
Also fails (differently) JTREG_TEST_THREAD_FACTORY=Virtual&lt;br/&gt;
&lt;br/&gt;
java.lang.RuntimeException: Thread MainThread is not supposed to be hold any lock. Currently owning lock : &lt;a href=&apos;mailto:java.lang.VirtualThread@48836641&apos;&gt;java.lang.VirtualThread@48836641&lt;/a&gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at Locks.assertNoLock(Locks.java:72)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at Locks.main(Locks.java:353)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.base/java.lang.reflect.Method.invoke(Method.java:580)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at com.sun.javatest.regtest.agent.MainWrapper$MainTask.run(MainWrapper.java:138)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.base/java.lang.VirtualThread.run(VirtualThread.java:311)&lt;br/&gt;
		&lt;br/&gt;
</comment>
                            <comment id="14575058" author="dnsimon" created="Wed, 19 Apr 2023 06:01:19 -0700"  >The most likely cause is one of the JVMCI compiler threads going idle and being stopped in between the call to getAllThreadIds and getThreadInfo. I think the test should just defend against the getThreadInfo call possibly returning null.</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5143110">JDK-8343602</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5158069">JDK-8356454</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5095889">JDK-8303916</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5139253">JDK-8340276</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="103745" name="Locks.jtr" size="15280" author="dnsimon" created="Mon, 8 May 2023 02:07:29 -0700"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i316qj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17336"><![CDATA[b09]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="194"><![CDATA[java.lang.management]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>