<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Sat Sep 27 10:27:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8335181] Incorrect handling of HTTP/2 GOAWAY frames in HttpClient</title>
                <link>https://bugs.openjdk.org/browse/JDK-8335181</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>A DESCRIPTION OF THE PROBLEM :&lt;br/&gt;
The setup is &lt;br/&gt;
- nginx as reverse proxy with SSL and http/2&lt;br/&gt;
- REST API behind nginx&lt;br/&gt;
&lt;br/&gt;
The application performs many requests to that API using HttpClient from JDK, which automatically detects http/2 via ALPN.&lt;br/&gt;
nginx closes connection after 1000 requests, configurable with the keepalive_requests directive (applies for both http/1.1 persistent connections and http/2).&lt;br/&gt;
&lt;br/&gt;
If specifically configuring the client as http/1.1 then everything works.&lt;br/&gt;
&lt;br/&gt;
Also happens in java 17.&lt;br/&gt;
&lt;br/&gt;
The stacktrace is &lt;br/&gt;
&lt;br/&gt;
java.io.IOException: /172.30.30.7:51892: GOAWAY received&lt;br/&gt;
	at java.net.http/jdk.internal.net.http.Http2Connection.handleGoAway(Http2Connection.java:1011)&lt;br/&gt;
	at java.net.http/jdk.internal.net.http.Http2Connection.handleConnectionFrame(Http2Connection.java:876)&lt;br/&gt;
	at java.net.http/jdk.internal.net.http.Http2Connection.processFrame(Http2Connection.java:751)&lt;br/&gt;
	at java.net.http/jdk.internal.net.http.frame.FramesDecoder.decode(FramesDecoder.java:155)&lt;br/&gt;
	at java.net.http/jdk.internal.net.http.Http2Connection$FramesController.processReceivedData(Http2Connection.java:232)&lt;br/&gt;
	at java.net.http/jdk.internal.net.http.Http2Connection.asyncReceive(Http2Connection.java:677)&lt;br/&gt;
	at java.net.http/jdk.internal.net.http.Http2Connection$Http2TubeSubscriber.processQueue(Http2Connection.java:1313)&lt;br/&gt;
&lt;br/&gt;
All suggesting to either downgrade to http/1.1 or change the client.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
        <key id="5132510">JDK-8335181</key>
            <summary>Incorrect handling of HTTP/2 GOAWAY frames in HttpClient</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://bugs.openjdk.org/images/jbsImages/p3.png">P3</priority>
                        <status id="6" iconUrl="https://bugs.openjdk.org/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jpai">Jaikiran Pai</assignee>
                                    <reporter username="webbuggrp">Webbug Group</reporter>
                        <labels>
                            <label>dcscg</label>
                            <label>dcslnk</label>
                            <label>jdk17u-fix-request</label>
                            <label>jdk17u-fix-yes</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                            <label>webbug</label>
                    </labels>
                <created>Mon, 24 Jun 2024 02:07:39 -0700</created>
                <updated>Fri, 1 Aug 2025 06:21:28 -0700</updated>
                            <resolved>Tue, 13 Aug 2024 22:43:14 -0700</resolved>
                                    <version>11</version>
                    <version>17</version>
                                    <fixVersion>24</fixVersion>
                                    <component>core-libs</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                                                                <comments>
                            <comment id="14803787" author="goetz" created="Mon, 28 Jul 2025 04:40:17 -0700"  >Fix request [17u]&lt;br/&gt;
&lt;br/&gt;
I backport this for parity with 17.0.17-oracle based on the patch to 21.&lt;br/&gt;
Medium risk, but part of the large http backport effort.&lt;br/&gt;
Resolved Copyright.&lt;br/&gt;
Tests pass. SAP nightly testing passed.</comment>
                            <comment id="14803163" author="roboduke" created="Thu, 24 Jul 2025 08:43:37 -0700"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk17u-dev/pull/3783&quot;&gt;https://git.openjdk.org/jdk17u-dev/pull/3783&lt;/a&gt;&lt;br/&gt;
Date: 2025-07-24 15:36:24 +0000</comment>
                            <comment id="14762335" author="abakhtin" created="Wed, 19 Mar 2025 18:32:16 -0700"  >Fix request [21u]&lt;br/&gt;
&lt;br/&gt;
I&amp;#39;d like to backport this fix into JDK21 for parity with Oracle.&lt;br/&gt;
Risk minimal. All related jtreg tests passed</comment>
                            <comment id="14755006" author="roboduke" created="Wed, 19 Feb 2025 16:06:11 -0800"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u-dev/pull/1417&quot;&gt;https://git.openjdk.org/jdk21u-dev/pull/1417&lt;/a&gt;&lt;br/&gt;
Date: 2025-02-20 00:00:26 +0000</comment>
                            <comment id="14710140" author="roboduke" created="Thu, 3 Oct 2024 13:14:17 -0700"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u-dev/pull/1020&quot;&gt;https://git.openjdk.org/jdk21u-dev/pull/1020&lt;/a&gt;&lt;br/&gt;
Date: 2024-10-03 20:06:12 +0000</comment>
                            <comment id="14698095" author="dukebot" created="Tue, 13 Aug 2024 22:43:13 -0700"  >Changeset: 720b4464&lt;br/&gt;
Branch: master&lt;br/&gt;
Author:    Jaikiran Pai &amp;lt;&lt;a href=&apos;mailto:jpai@openjdk.org&apos;&gt;jpai@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2024-08-14 05:42:14 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/720b44648bcff997278af92746f942b2425298a5&quot;&gt;https://git.openjdk.org/jdk/commit/720b44648bcff997278af92746f942b2425298a5&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14697918" author="roboduke" created="Tue, 13 Aug 2024 06:36:59 -0700"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/20567&quot;&gt;https://git.openjdk.org/jdk/pull/20567&lt;/a&gt;&lt;br/&gt;
Date: 2024-08-13 13:32:19 +0000</comment>
                            <comment id="14695382" author="roboduke" created="Fri, 2 Aug 2024 04:20:33 -0700"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/20442&quot;&gt;https://git.openjdk.org/jdk/pull/20442&lt;/a&gt;&lt;br/&gt;
Date: 2024-08-02 11:13:42 +0000</comment>
                            <comment id="14685628" author="dfuchs" created="Fri, 28 Jun 2024 01:48:38 -0700"  >When receiving GOAWAY we should mark the connection as final - so that it&amp;#39;s not used for new requests, and wait until all requests have completed before closing it. This should not be too different to what we do for the HTTP/2 IdleTimeout - except that we should not send back a GOAWAY. The received GOAWAY contains a streamId which is the last streamId that is/will be accepted by the peer, so if any request with a higher stream id is in progress on the connection, we should cancel it and retry it on a new connection.</comment>
                            <comment id="14685397" author="jpai" created="Thu, 27 Jun 2024 07:02:52 -0700"  >I thought we already had an issue for handling GOAWAY in a better way in our H2 connection implementation, but I can&amp;#39;t find it. I do however had work in progress changes in that area which I hadn&amp;#39;t prioritized. I will assign this to myself and prioritize it in the coming days.</comment>
                            <comment id="14685393" author="JIRAUSER19825" created="Thu, 27 Jun 2024 06:54:14 -0700"  >the problem is actually worse than that. When we receive a goaway frame, we don&amp;#39;t just abort the requests rejected by the frame, we also immediately close the connection and abort all requests that were in progress. This makes using parallel requests much harder than it needs to be: some servers send a GOAWAY frame when they receive the n-th request, and it&amp;#39;s likely that some requests will be in progress at that time.&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;https://github.com/openjdk/jdk/blob/d5375c7db658de491c1f5bad053040d21b82941e/src/java.net.http/share/classes/jdk/internal/net/http/Http2Connection.java#L1212&quot;&gt;https://github.com/openjdk/jdk/blob/d5375c7db658de491c1f5bad053040d21b82941e/src/java.net.http/share/classes/jdk/internal/net/http/Http2Connection.java#L1212&lt;/a&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5150655">JDK-8350030</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5153531">JDK-8352513</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5159754">JDK-8357902</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5167282">JDK-8364535</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10000">
                    <name>Blocks</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="5092664">JDK-8301255</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10000" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>CPU</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17008"><![CDATA[generic]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10005" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>OS</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17010"><![CDATA[generic]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i36urf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17311"><![CDATA[b11]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="193"><![CDATA[java.net]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10100" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Verification</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17000"><![CDATA[Verified]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>