<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Fri Sep 26 00:59:16 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8309754] java/security/cert/CertPathValidator/OCSP/OCSPTimeout.java failed with &quot;Expected to pass, found 1 soft fail exceptions&quot;</title>
                <link>https://bugs.openjdk.org/browse/JDK-8309754</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>The following test failed in the JDK22 CI:&lt;br/&gt;
&lt;br/&gt;
java/security/cert/CertPathValidator/OCSP/OCSPTimeout.java&lt;br/&gt;
&lt;br/&gt;
Here&amp;#39;s a snippet from the log file:&lt;br/&gt;
&lt;br/&gt;
#section:main&lt;br/&gt;
----------messages:(7/575)----------&lt;br/&gt;
command: main -Dcom.sun.security.ocsp.readtimeout=2750ms OCSPTimeout 2000 true&lt;br/&gt;
reason: User specified action: run main/othervm -Dcom.sun.security.ocsp.readtimeout=2750ms OCSPTimeout 2000 true &lt;br/&gt;
started: Fri Jun 09 21:20:32 UTC 2023&lt;br/&gt;
Mode: othervm [/othervm specified]&lt;br/&gt;
Additional options from @modules: --add-modules java.base --add-exports java.base/sun.security.x509=ALL-UNNAMED --add-exports java.base/sun.security.provider.certpath=ALL-UNNAMED --add-exports java.base/sun.security.util=ALL-UNNAMED&lt;br/&gt;
finished: Fri Jun 09 21:20:38 UTC 2023&lt;br/&gt;
elapsed time (seconds): 5.427&lt;br/&gt;
----------configuration:(6/279)----------&lt;br/&gt;
Boot Layer&lt;br/&gt;
&amp;nbsp;&amp;nbsp;add modules: java.base                                &lt;br/&gt;
&amp;nbsp;&amp;nbsp;add exports: java.base/sun.security.provider.certpath ALL-UNNAMED&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;java.base/sun.security.util              ALL-UNNAMED&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;java.base/sun.security.x509              ALL-UNNAMED&lt;br/&gt;
&lt;br/&gt;
----------System.out:(19/658)----------&lt;br/&gt;
Generated Root CA KeyPair&lt;br/&gt;
Generated End Entity KeyPair&lt;br/&gt;
Root CA Created:&lt;br/&gt;
Issuer: CN=Root CA Cert, O=SomeCompany&lt;br/&gt;
Subject: CN=Root CA Cert, O=SomeCompany&lt;br/&gt;
Serial: 1&lt;br/&gt;
&lt;br/&gt;
[MainThread]: nextUpdate set to Fri Jun 09 22:20:34 UTC 2023&lt;br/&gt;
[MainThread]: Response Content-Length field disabled&lt;br/&gt;
[pool-1-thread-1]: Listening on 0.0.0.0/0.0.0.0:63089&lt;br/&gt;
Root OCSP Responder URI is &lt;a href=&quot;http://localhost:63089&quot;&gt;http://localhost:63089&lt;/a&gt;&lt;br/&gt;
SSL Certificate Created:&lt;br/&gt;
Issuer: CN=Root CA Cert, O=SomeCompany&lt;br/&gt;
Subject: CN=SSLCertificate, O=SomeCompany&lt;br/&gt;
Serial: 4096&lt;br/&gt;
&lt;br/&gt;
[MainThread]: Added entry for serial 4096(CERT_STATUS_GOOD)&lt;br/&gt;
[MainThread]: OCSP latency set to 2000 milliseconds.&lt;br/&gt;
Test case expects to pass&lt;br/&gt;
----------System.err:(11/700)----------&lt;br/&gt;
java.lang.RuntimeException: Expected to pass, found 1 soft fail exceptions&lt;br/&gt;
	at OCSPTimeout.main(OCSPTimeout.java:116)&lt;br/&gt;
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)&lt;br/&gt;
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)&lt;br/&gt;
	at com.sun.javatest.regtest.agent.MainWrapper$MainTask.run(MainWrapper.java:138)&lt;br/&gt;
	at java.base/java.lang.Thread.run(Thread.java:1583)&lt;br/&gt;
&lt;br/&gt;
JavaTest Message: Test threw exception: java.lang.RuntimeException: Expected to pass, found 1 soft fail exceptions&lt;br/&gt;
JavaTest Message: shutting down test&lt;br/&gt;
&lt;br/&gt;
STATUS:Failed.`main&amp;#39; threw exception: java.lang.RuntimeException: Expected to pass, found 1 soft fail exceptions&lt;br/&gt;
----------rerun:(46/6462)*----------</description>
                <environment></environment>
        <key id="5102850">JDK-8309754</key>
            <summary>java/security/cert/CertPathValidator/OCSP/OCSPTimeout.java failed with &quot;Expected to pass, found 1 soft fail exceptions&quot;</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://bugs.openjdk.org/images/jbsImages/p3.png">P3</priority>
                        <status id="3" iconUrl="https://bugs.openjdk.org/images/icons/statuses/inprogress.png" description="This issue is being actively worked on at the moment by the assignee.">In Progress</status>
                    <statusCategory id="4" key="indeterminate" colorName="inprogress"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="jnimeh">Jamil Nimeh</assignee>
                                    <reporter username="dcubed">Daniel Daugherty</reporter>
                        <labels>
                            <label>CPU25_07-defer-SQE-OK</label>
                            <label>CPU25_07-defer-approved</label>
                            <label>intermittent</label>
                            <label>tier2</label>
                    </labels>
                <created>Fri, 9 Jun 2023 14:54:11 -0700</created>
                <updated>Mon, 23 Jun 2025 23:05:07 -0700</updated>
                                            <version>17.0.16-oracle</version>
                    <version>21</version>
                    <version>22</version>
                    <version>23</version>
                                    <fixVersion>tbd</fixVersion>
                                    <component>security-libs</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="14729055" author="JIRAUSER20909" created="Thu, 5 Dec 2024 10:01:06 -0800"  >Hi [~jnimeh],&lt;br/&gt;
&lt;br/&gt;
Please note that the parallelism I employed to reproduce wasn&amp;#39;t at the thread but at the process level. Just opened 4 Cygwin Bash terminals at the JDK repository built in slowdebug and pasted something like this:&lt;br/&gt;
~~~&lt;br/&gt;
JDK_IMG=&amp;quot;$(cygpath -am build/windows-x86_64-server-slowdebug/images/jdk)&amp;quot;&lt;br/&gt;
for _ in `seq 100`; do&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;OUT=&amp;quot;$(cygpath -m &amp;quot;$(mktemp -dt test_XXXXXXXXXX)&amp;quot;)&amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;jtreg -jdk:$JDK_IMG -w:$OUT/work -r:$OUT/work -timeout:8 \&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;test/jdk/java/security/cert/CertPathValidator/OCSP/OCSPTimeout.java&lt;br/&gt;
done&lt;br/&gt;
~~~&lt;br/&gt;
&lt;br/&gt;
So just heavy load plus more chances of hitting the issue (400 independent executions of the test).</comment>
                            <comment id="14727828" author="jnimeh" created="Tue, 3 Dec 2024 09:28:12 -0800"  >[~fferrari] Thanks for the detailed information on the replicated failure.  I will try running it inside of multiple threads to see if I can reproduce it, but I will also review the info you&amp;#39;ve provided.  I should probably go back and look at the OCSP server code.  Since you were able to make it happen in multiple threads, I wonder if there might be some thread lock contention that contributes to the delay.  I would think the hold and releases of the locks should be pretty fast, but couple that with the increase load and who knows?&lt;br/&gt;
Anyhow, I really appreciate the detailed information.</comment>
                            <comment id="14725731" author="JIRAUSER20909" created="Sat, 23 Nov 2024 08:55:27 -0800"  >Hi [~jnimeh],&lt;br/&gt;
&lt;br/&gt;
I&amp;#39;ve managed to reproduce this issue (or a similar one) with a slowdebug build of the mainline repository, in a Windows 11 VM. The VM has 4 CPU cores, I parallely opened 4 terminals and ran 100 rounds of the OCSPTimeout test in each one. Out of the total 400 runs, 3 failed. I&amp;#39;ve attached the full OCSPTimeout.jtr.&lt;br/&gt;
&lt;br/&gt;
In order to have the full stack trace of the &amp;quot;soft fail exceptions&amp;quot; I applied the following patch:&lt;br/&gt;
&lt;br/&gt;
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~&lt;br/&gt;
diff --git a/test/jdk/java/security/cert/CertPathValidator/OCSP/OCSPTimeout.java b/test/jdk/java/security/cert/CertPathValidator/OCSP/OCSPTimeout.java&lt;br/&gt;
index dfd7dcdc81e..5a8d3faab07 100644&lt;br/&gt;
--- a/test/jdk/java/security/cert/CertPathValidator/OCSP/OCSPTimeout.java&lt;br/&gt;
+++ b/test/jdk/java/security/cert/CertPathValidator/OCSP/OCSPTimeout.java&lt;br/&gt;
@@ -114,9 +114,12 @@ public static void main(String[] args) throws Exception {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if (expected) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if (!softExc.isEmpty()) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;log(&amp;quot;Expected to pass, found &amp;quot; + softExc.size() +&lt;br/&gt;
-                            &amp;quot; soft fail exceptions&amp;quot;);&lt;br/&gt;
+                            &amp;quot; soft fail exceptions:&amp;quot;);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;for (CertPathValidatorException cpve : softExc) {&lt;br/&gt;
-                        log(&amp;quot;Exception: &amp;quot; + cpve);&lt;br/&gt;
+                        try (StringWriter sw = new StringWriter()){&lt;br/&gt;
+                            cpve.printStackTrace(new PrintWriter(sw));&lt;br/&gt;
+                            log(&amp;quot;----\n%s&amp;quot;, sw.toString());&lt;br/&gt;
+                        }&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;throw new RuntimeException(&amp;quot;Expected to pass, found &amp;quot; +&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;softExc.size() + &amp;quot; soft fail exceptions&amp;quot;);&lt;br/&gt;
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~&lt;br/&gt;
&lt;br/&gt;
And here it is:&lt;br/&gt;
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~&lt;br/&gt;
----&lt;br/&gt;
java.security.cert.CertPathValidatorException: Unable to determine revocation status due to network error&lt;br/&gt;
	at java.base/sun.security.provider.certpath.RevocationChecker.isSoftFailException(RevocationChecker.java:436)&lt;br/&gt;
	at java.base/sun.security.provider.certpath.RevocationChecker.check(RevocationChecker.java:381)&lt;br/&gt;
	at java.base/sun.security.provider.certpath.RevocationChecker.check(RevocationChecker.java:343)&lt;br/&gt;
	at java.base/sun.security.provider.certpath.PKIXMasterCertPathValidator.validate(PKIXMasterCertPathValidator.java:125)&lt;br/&gt;
	at java.base/sun.security.provider.certpath.PKIXCertPathValidator.validate(PKIXCertPathValidator.java:224)&lt;br/&gt;
	at java.base/sun.security.provider.certpath.PKIXCertPathValidator.validate(PKIXCertPathValidator.java:144)&lt;br/&gt;
	at java.base/sun.security.provider.certpath.PKIXCertPathValidator.engineValidate(PKIXCertPathValidator.java:83)&lt;br/&gt;
	at java.base/java.security.cert.CertPathValidator.validate(CertPathValidator.java:309)&lt;br/&gt;
	at OCSPTimeout.main(OCSPTimeout.java:110)&lt;br/&gt;
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)&lt;br/&gt;
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)&lt;br/&gt;
	at com.sun.javatest.regtest.agent.MainWrapper$MainTask.run(MainWrapper.java:138)&lt;br/&gt;
	at java.base/java.lang.Thread.run(Thread.java:1447)&lt;br/&gt;
Caused by: java.net.SocketTimeoutException: Read timed out&lt;br/&gt;
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:278)&lt;br/&gt;
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:304)&lt;br/&gt;
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:346)&lt;br/&gt;
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:796)&lt;br/&gt;
	at java.base/java.net.Socket$SocketInputStream.implRead(Socket.java:981)&lt;br/&gt;
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:968)&lt;br/&gt;
	at java.base/java.io.BufferedInputStream.fill(BufferedInputStream.java:289)&lt;br/&gt;
	at java.base/java.io.BufferedInputStream.read1(BufferedInputStream.java:330)&lt;br/&gt;
	at java.base/java.io.BufferedInputStream.read(BufferedInputStream.java:388)&lt;br/&gt;
	at java.base/sun.net.&lt;a href=&quot;http://www.http.HttpClient.parseHTTPHeader(HttpClient.java:827)&quot;&gt;www.http.HttpClient.parseHTTPHeader(HttpClient.java:827)&lt;/a&gt;&lt;br/&gt;
	at java.base/sun.net.&lt;a href=&quot;http://www.http.HttpClient.parseHTTP(HttpClient.java:759)&quot;&gt;www.http.HttpClient.parseHTTP(HttpClient.java:759)&lt;/a&gt;&lt;br/&gt;
	at java.base/sun.net.&lt;a href=&quot;http://www.protocol.http.HttpURLConnection.getInputStream0(HttpURLConnection.java:1391)&quot;&gt;www.protocol.http.HttpURLConnection.getInputStream0(HttpURLConnection.java:1391)&lt;/a&gt;&lt;br/&gt;
	at java.base/sun.net.&lt;a href=&quot;http://www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1301)&quot;&gt;www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1301)&lt;/a&gt;&lt;br/&gt;
	at java.base/java.net.HttpURLConnection.getResponseCode(HttpURLConnection.java:506)&lt;br/&gt;
	at java.base/sun.security.provider.certpath.OCSP.getOCSPBytes(OCSP.java:248)&lt;br/&gt;
	at java.base/sun.security.provider.certpath.OCSP.check(OCSP.java:168)&lt;br/&gt;
	at java.base/sun.security.provider.certpath.RevocationChecker.checkOCSP(RevocationChecker.java:780)&lt;br/&gt;
	at java.base/sun.security.provider.certpath.RevocationChecker.check(RevocationChecker.java:369)&lt;br/&gt;
	... 11 more&lt;br/&gt;
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~&lt;br/&gt;
&lt;br/&gt;
Additionally, it seems the OCSP server had already started writing when the OCSP client read timeout occurred:&lt;br/&gt;
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~&lt;br/&gt;
[pool-2-thread-1][1732348368333]: Status for SN 4096: CERT_STATUS_GOOD&lt;br/&gt;
[pool-2-thread-1]: Exception: java.net.SocketException: An established connection was aborted by the software in your host machine&lt;br/&gt;
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)&lt;br/&gt;
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)&lt;br/&gt;
	at java.base/sun.nio.ch.NioSocketImpl.tryWrite(NioSocketImpl.java:394)&lt;br/&gt;
	at java.base/sun.nio.ch.NioSocketImpl.implWrite(NioSocketImpl.java:410)&lt;br/&gt;
	at java.base/sun.nio.ch.NioSocketImpl.write(NioSocketImpl.java:440)&lt;br/&gt;
	at java.base/sun.nio.ch.NioSocketImpl$2.write(NioSocketImpl.java:819)&lt;br/&gt;
	at java.base/java.net.Socket$SocketOutputStream.implWrite(Socket.java:1096)&lt;br/&gt;
	at java.base/java.net.Socket$SocketOutputStream.write(Socket.java:1083)&lt;br/&gt;
	at java.base/java.io.OutputStream.write(OutputStream.java:124)&lt;br/&gt;
	at sun.security.testlibrary.SimpleOCSPServer$OcspHandler.sendResponse(SimpleOCSPServer.java:831)&lt;br/&gt;
	at sun.security.testlibrary.SimpleOCSPServer$OcspHandler.run(SimpleOCSPServer.java:793)&lt;br/&gt;
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:545)&lt;br/&gt;
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:328)&lt;br/&gt;
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1095)&lt;br/&gt;
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:619)&lt;br/&gt;
	at java.base/java.lang.Thread.run(Thread.java:1447)&lt;br/&gt;
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
It seems like the 5s read timeout (-Dcom.sun.security.ocsp.readtimeout=5) is not enough. If we analyze the times around the message &amp;quot;Test case expects to pass/fail&amp;quot;, we can observe the following:&lt;br/&gt;
&lt;br/&gt;
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~&lt;br/&gt;
&lt;a href=&apos;mailto:test@vmwinwork&apos;&gt;test@vmwinwork&lt;/a&gt;:~$ grep -C1 &amp;#39;Test case expects to&amp;#39; OCSPTimeout.jtr&lt;br/&gt;
[MainThread][1732348313182]: OCSP latency set to 1000 milliseconds.&lt;br/&gt;
Test case expects to pass&lt;br/&gt;
[pool-2-thread-1][1732348315366]: Delaying response for 1000 milliseconds.&lt;br/&gt;
--&lt;br/&gt;
[MainThread][1732348360440]: OCSP latency set to 1000 milliseconds.&lt;br/&gt;
Test case expects to pass&lt;br/&gt;
[pool-2-thread-1][1732348367153]: Delaying response for 1000 milliseconds.&lt;br/&gt;
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~&lt;br/&gt;
&lt;br/&gt;
The first occurrence is from the first run, with the following parameters:&lt;br/&gt;
-Djava.security.debug=certpath OCSPTimeout 1000 true&lt;br/&gt;
&lt;a href=&quot;https://github.com/openjdk/jdk/blob/jdk-24+24/test/jdk/java/security/cert/CertPathValidator/OCSP/OCSPTimeout.java#L39&quot;&gt;https://github.com/openjdk/jdk/blob/jdk-24+24/test/jdk/java/security/cert/CertPathValidator/OCSP/OCSPTimeout.java#L39&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
The second occurrence is from the second run, with the following parameters:&lt;br/&gt;
-Djava.security.debug=certpath -Dcom.sun.security.ocsp.readtimeout=5 OCSPTimeout 1000 true&lt;br/&gt;
&lt;a href=&quot;https://github.com/openjdk/jdk/blob/jdk-24+24/test/jdk/java/security/cert/CertPathValidator/OCSP/OCSPTimeout.java#L40-L41&quot;&gt;https://github.com/openjdk/jdk/blob/jdk-24+24/test/jdk/java/security/cert/CertPathValidator/OCSP/OCSPTimeout.java#L40-L41&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
In each run:&lt;br/&gt;
&lt;br/&gt;
1. The first timestamp is printed by the main thread, when it sets the OCSP server delay:&lt;br/&gt;
&lt;a href=&quot;https://github.com/openjdk/jdk/blob/jdk-24+24/test/jdk/java/security/cert/CertPathValidator/OCSP/OCSPTimeout.java#L95&quot;&gt;https://github.com/openjdk/jdk/blob/jdk-24+24/test/jdk/java/security/cert/CertPathValidator/OCSP/OCSPTimeout.java#L95&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://github.com/openjdk/jdk/blob/jdk-24+24/test/jdk/java/security/testlibrary/SimpleOCSPServer.java#L547&quot;&gt;https://github.com/openjdk/jdk/blob/jdk-24+24/test/jdk/java/security/testlibrary/SimpleOCSPServer.java#L547&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
2. The &amp;quot;Test case expects to pass&amp;quot; message is printed by the main thread immediately after.&lt;br/&gt;
&lt;br/&gt;
3. The second timestamp is printed by the OCSP server thread, when a new connection is accepted, and it executes the OcspHandler runnable:&lt;br/&gt;
&lt;a href=&quot;https://github.com/openjdk/jdk/blob/jdk-24+24/test/jdk/java/security/testlibrary/SimpleOCSPServer.java#L240&quot;&gt;https://github.com/openjdk/jdk/blob/jdk-24+24/test/jdk/java/security/testlibrary/SimpleOCSPServer.java#L240&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://github.com/openjdk/jdk/blob/jdk-24+24/test/jdk/java/security/testlibrary/SimpleOCSPServer.java#L730&quot;&gt;https://github.com/openjdk/jdk/blob/jdk-24+24/test/jdk/java/security/testlibrary/SimpleOCSPServer.java#L730&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
The elapsed time between the two timestamps for the first run is:&lt;br/&gt;
1732348315366 - 1732348313182 = 2184 ms = 2.184 s&lt;br/&gt;
&lt;br/&gt;
The elapsed time between the two timestamps for the second run is:&lt;br/&gt;
1732348367153 - 1732348360440 = 6713 ms = 6.713 s&lt;br/&gt;
&lt;br/&gt;
Assuming the elapsed time between the following lines is small enough:&lt;br/&gt;
&lt;a href=&quot;https://github.com/openjdk/jdk/blob/jdk-24+24/test/jdk/java/security/cert/CertPathValidator/OCSP/OCSPTimeout.java#L95-L110&quot;&gt;https://github.com/openjdk/jdk/blob/jdk-24+24/test/jdk/java/security/cert/CertPathValidator/OCSP/OCSPTimeout.java#L95-L110&lt;/a&gt;&lt;br/&gt;
We can assume the connection to the OCSP server was fired less than 1 second after the first timestamp.&lt;br/&gt;
&lt;br/&gt;
During the second run, for some reason, the server received or handled the connection more than 5 seconds after it was started by the client. This caused the read timeout on the client side. I would associate this with a temporary networking slowdown while Windows is virtualized and under heavy load.</comment>
                            <comment id="14695921" author="jnimeh" created="Mon, 5 Aug 2024 09:17:57 -0700"  >Stopping work on this pending the logging enhancements in &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8337826&quot; title=&quot;Improve logging in OCSPTimeout and SimpleOCSPResponder to help diagnose JDK-8309754&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8337826&quot;&gt;&lt;strike&gt;JDK-8337826&lt;/strike&gt;&lt;/a&gt; and a recurrence of this in some environment somewhere with (hopefully) some additional clues as to the issue.</comment>
                            <comment id="14650006" author="dcubed" created="Fri, 16 Feb 2024 07:15:51 -0800"  >Here&amp;#39;s a log file snippet from the jdk-23+11-742-tier2 sighting:&lt;br/&gt;
&lt;br/&gt;
java/security/cert/CertPathValidator/OCSP/OCSPTimeout.java&lt;br/&gt;
&lt;br/&gt;
#section:main&lt;br/&gt;
----------messages:(7/566)----------&lt;br/&gt;
command: main -Dcom.sun.security.ocsp.readtimeout=5 OCSPTimeout 1000 true&lt;br/&gt;
reason: User specified action: run main/othervm -Dcom.sun.security.ocsp.readtimeout=5 OCSPTimeout 1000 true &lt;br/&gt;
started: Fri Feb 16 09:24:07 UTC 2024&lt;br/&gt;
Mode: othervm [/othervm specified]&lt;br/&gt;
Additional options from @modules: --add-modules java.base --add-exports java.base/sun.security.x509=ALL-UNNAMED --add-exports java.base/sun.security.provider.certpath=ALL-UNNAMED --add-exports java.base/sun.security.util=ALL-UNNAMED&lt;br/&gt;
finished: Fri Feb 16 09:24:36 UTC 2024&lt;br/&gt;
elapsed time (seconds): 28.829&lt;br/&gt;
----------configuration:(6/279)----------&lt;br/&gt;
&lt;br/&gt;
&amp;lt;snip&amp;gt;&lt;br/&gt;
&lt;br/&gt;
----------System.out:(24/919)----------&lt;br/&gt;
Generated Root CA KeyPair&lt;br/&gt;
Generated End Entity KeyPair&lt;br/&gt;
Root CA Created:&lt;br/&gt;
Issuer: CN=Root CA Cert, O=SomeCompany&lt;br/&gt;
Subject: CN=Root CA Cert, O=SomeCompany&lt;br/&gt;
Serial: 1&lt;br/&gt;
&lt;br/&gt;
[MainThread]: nextUpdate set to Fri Feb 16 10:24:09 UTC 2024&lt;br/&gt;
[MainThread]: Response Content-Length field disabled&lt;br/&gt;
[pool-1-thread-1]: Listening on 0.0.0.0/0.0.0.0:50947&lt;br/&gt;
Root OCSP Responder URI is &lt;a href=&quot;http://localhost:50947&quot;&gt;http://localhost:50947&lt;/a&gt;&lt;br/&gt;
SSL Certificate Created:&lt;br/&gt;
Issuer: CN=Root CA Cert, O=SomeCompany&lt;br/&gt;
Subject: CN=SSLCertificate, O=SomeCompany&lt;br/&gt;
Serial: 4096&lt;br/&gt;
&lt;br/&gt;
[MainThread]: Added entry for serial 4096(CERT_STATUS_GOOD)&lt;br/&gt;
[MainThread]: OCSP latency set to 1000 milliseconds.&lt;br/&gt;
Test case expects to pass&lt;br/&gt;
[pool-2-thread-1]: Received incoming HTTP GET from /127.0.0.1:50949&lt;br/&gt;
[pool-2-thread-1]: ReqHdr: User-Agent: Java/23-ea&lt;br/&gt;
[pool-2-thread-1]: ReqHdr: Host: localhost:50947&lt;br/&gt;
[pool-2-thread-1]: ReqHdr: Accept: */*&lt;br/&gt;
[pool-2-thread-1]: ReqHdr: Connection: keep-alive&lt;br/&gt;
----------System.err:(11/700)----------&lt;br/&gt;
java.lang.RuntimeException: Expected to pass, found 1 soft fail exceptions&lt;br/&gt;
	at OCSPTimeout.main(OCSPTimeout.java:116)&lt;br/&gt;
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)&lt;br/&gt;
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)&lt;br/&gt;
	at com.sun.javatest.regtest.agent.MainWrapper$MainTask.run(MainWrapper.java:138)&lt;br/&gt;
	at java.base/java.lang.Thread.run(Thread.java:1575)&lt;br/&gt;
&lt;br/&gt;
JavaTest Message: Test threw exception: java.lang.RuntimeException: Expected to pass, found 1 soft fail exceptions&lt;br/&gt;
JavaTest Message: shutting down test&lt;br/&gt;
&lt;br/&gt;
STATUS:Failed.`main&amp;#39; threw exception: java.lang.RuntimeException: Expected to pass, found 1 soft fail exceptions&lt;br/&gt;
----------rerun:(47/6592)*----------&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
This bug was previous closed as a duplicate of:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8309740&quot; title=&quot;Expand timeout windows for tests in JDK-8179502&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8309740&quot;&gt;&lt;strike&gt;JDK-8309740&lt;/strike&gt;&lt;/a&gt; Expand timeout windows for tests in &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8179502&quot; title=&quot;Enhance OCSP, CRL and Certificate Fetch Timeouts&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8179502&quot;&gt;&lt;strike&gt;JDK-8179502&lt;/strike&gt;&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
However, that fix was integrated in jdk-21+29 and this failure&lt;br/&gt;
matches the original failure mode for this bug. So I have reopened&lt;br/&gt;
this bug and added the new sighting.</comment>
                            <comment id="14588507" author="jnimeh" created="Mon, 12 Jun 2023 06:42:21 -0700"  >Duplicate of &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8309740&quot; title=&quot;Expand timeout windows for tests in JDK-8179502&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8309740&quot;&gt;&lt;strike&gt;JDK-8309740&lt;/strike&gt;&lt;/a&gt;</comment>
                            <comment id="14588503" author="jnimeh" created="Mon, 12 Jun 2023 06:36:58 -0700"  >I will close this as a duplicate of &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8309740&quot; title=&quot;Expand timeout windows for tests in JDK-8179502&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8309740&quot;&gt;&lt;strike&gt;JDK-8309740&lt;/strike&gt;&lt;/a&gt;, which covers this test along with two similar tests that were introduced as part of &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8179502&quot; title=&quot;Enhance OCSP, CRL and Certificate Fetch Timeouts&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8179502&quot;&gt;&lt;strike&gt;JDK-8179502&lt;/strike&gt;&lt;/a&gt;.  The SAP folks were seeing all three intermittently fail.  I had hoped the time windows would be long enough but apparently not in certain cases.  I have a proposed patch which the SAP folks are trying out that extends the time windows so they are all at least 1.5 seconds to allow the test endpoints to reach their proper states.</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5102831">JDK-8309740</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="4922662">JDK-8179502</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5136132">JDK-8337826</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="112198" name="OCSPTimeout.jtr" size="59909" author="fferrari" created="Sat, 23 Nov 2024 08:51:49 -0800"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10000" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>CPU</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="19000"><![CDATA[x86_64]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10005" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>OS</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17005"><![CDATA[windows]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i31uj7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="195"><![CDATA[java.security]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>