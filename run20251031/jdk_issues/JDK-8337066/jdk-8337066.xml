<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Sat Sep 27 09:12:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8337066] Repeated call of StringBuffer.reverse with double byte string returns wrong result</title>
                <link>https://bugs.openjdk.org/browse/JDK-8337066</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>When calling StringBuffer/StringBuilder.reverse with 2byte string repeatedly, the API returns wrong result.</description>
                <environment></environment>
        <key id="5135014">JDK-8337066</key>
            <summary>Repeated call of StringBuffer.reverse with double byte string returns wrong result</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://bugs.openjdk.org/images/jbsImages/p2.png">P2</priority>
                        <status id="6" iconUrl="https://bugs.openjdk.org/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="iveresov">Igor Veresov</assignee>
                                    <reporter username="shadowbug">Shadow Bug</reporter>
                        <labels>
                            <label>bugdb_36875407</label>
                            <label>bugdb_37013421</label>
                            <label>c2</label>
                            <label>jdk17u-fix-request</label>
                            <label>jdk17u-fix-yes</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                            <label>jdk23u-fix-SQE-ok</label>
                            <label>jdk23u-fix-request</label>
                            <label>jdk23u-fix-yes</label>
                            <label>oracle-triage-11</label>
                    </labels>
                <created>Tue, 23 Jul 2024 21:18:34 -0700</created>
                <updated>Fri, 24 Jan 2025 06:00:30 -0800</updated>
                            <resolved>Tue, 8 Oct 2024 16:57:36 -0700</resolved>
                                    <version>11</version>
                    <version>17</version>
                    <version>21</version>
                    <version>24</version>
                                    <fixVersion>24</fixVersion>
                                    <component>hotspot</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>14</watches>
                                                                                                                <comments>
                            <comment id="14722125" author="roboduke" created="Wed, 13 Nov 2024 12:53:32 -0800"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk11u-dev/pull/2961&quot;&gt;https://git.openjdk.org/jdk11u-dev/pull/2961&lt;/a&gt;&lt;br/&gt;
Date: 2024-11-08 12:44:55 +0000</comment>
                            <comment id="14718363" author="roboduke" created="Thu, 31 Oct 2024 13:03:06 -0700"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk17u-dev/pull/3021&quot;&gt;https://git.openjdk.org/jdk17u-dev/pull/3021&lt;/a&gt;&lt;br/&gt;
Date: 2024-10-31 19:56:27 +0000</comment>
                            <comment id="14718362" author="roboduke" created="Thu, 31 Oct 2024 13:03:02 -0700"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u-dev/pull/1116&quot;&gt;https://git.openjdk.org/jdk21u-dev/pull/1116&lt;/a&gt;&lt;br/&gt;
Date: 2024-10-31 19:56:16 +0000</comment>
                            <comment id="14718360" author="goetz" created="Thu, 31 Oct 2024 12:55:17 -0700"  >Fix request [17u,21u]&lt;br/&gt;
&lt;br/&gt;
I backport this for parity with 17.0.14-oracle,21.0.6-oracle from 23.&lt;br/&gt;
Simple change, but typical C2 risk.  Related issues require no follow-up backport. &lt;br/&gt;
Clean backport.&lt;br/&gt;
Test passes but does not reproduce the bug. SAP nightly testing passed.</comment>
                            <comment id="14713741" author="roboduke" created="Wed, 16 Oct 2024 13:08:26 -0700"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk23u/pull/187&quot;&gt;https://git.openjdk.org/jdk23u/pull/187&lt;/a&gt;&lt;br/&gt;
Date: 2024-10-16 20:02:03 +0000</comment>
                            <comment id="14713142" author="iveresov" created="Tue, 15 Oct 2024 10:17:29 -0700"  >[jdk23u-fix-request]&lt;br/&gt;
Critical for jdk11u (for later JDKs more of a defensive fix), customer reported issue leading to incorrect execution. Fix is medium risk. Applies with some minor tweaking. Tier1-3 passed.</comment>
                            <comment id="14711413" author="dukebot" created="Tue, 8 Oct 2024 16:57:30 -0700"  >Changeset: 7eab0a50&lt;br/&gt;
Branch: master&lt;br/&gt;
Author:    Igor Veresov &amp;lt;&lt;a href=&apos;mailto:iveresov@openjdk.org&apos;&gt;iveresov@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2024-10-08 23:21:44 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/7eab0a506adffac7bed940cc020e37754f0adbdb&quot;&gt;https://git.openjdk.org/jdk/commit/7eab0a506adffac7bed940cc020e37754f0adbdb&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14708970" author="thartmann" created="Sun, 29 Sep 2024 23:50:53 -0700"  >[~iveresov] So you can reproduce the TestAlignVectorFuzzer failure with mainline? Could you please file a separate bug for this?</comment>
                            <comment id="14708752" author="iveresov" created="Sun, 29 Sep 2024 13:03:14 -0700"  >I ran TestAlignVectorFuzzer a bunch of times during the weekend and this failure mode is preexisting. No caused by my change. So everything is clean.</comment>
                            <comment id="14708457" author="roboduke" created="Fri, 27 Sep 2024 09:07:08 -0700"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/21222&quot;&gt;https://git.openjdk.org/jdk/pull/21222&lt;/a&gt;&lt;br/&gt;
Date: 2024-09-27 16:02:29 +0000</comment>
                            <comment id="14705691" author="iveresov" created="Tue, 17 Sep 2024 14:59:20 -0700"  >So, the reason this is happening is that insert_anti_dependencies() assumes that the memory input for a load is the root of the memory subgraph that it has to search for the possibly conflicting store. Usually this is true if we run all the memory optimizations but with pinned we don&amp;#39;t. As a result we may end up with the graph like the one in the attached graph.pdf.&lt;br/&gt;
&lt;br/&gt;
The solution, I think, could be to walk up the memory chain of the load, skipping MergeMems, in order to get to the real root and then run the precedence edge insertion algorithm from there.&lt;br/&gt;
&lt;br/&gt;
Suggested fix:&lt;br/&gt;
&lt;br/&gt;
diff --git a/src/hotspot/share/opto/gcm.cpp b/src/hotspot/share/opto/gcm.cpp&lt;br/&gt;
index d940717dd3..b76ea00ba2 100644&lt;br/&gt;
--- a/src/hotspot/share/opto/gcm.cpp&lt;br/&gt;
+++ b/src/hotspot/share/opto/gcm.cpp&lt;br/&gt;
@@ -669,6 +669,15 @@ Block* PhaseCFG::insert_anti_dependences(Block* LCA, Node* load, bool verify) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;// The anti-dependence constraints apply only to the fringe of this tree.&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;Node* initial_mem = load-&amp;gt;in(MemNode::Memory);&lt;br/&gt;
+  if (load_alias_idx &amp;gt;= Compile::AliasIdxRaw) {&lt;br/&gt;
+    while (initial_mem-&amp;gt;is_MergeMem()) {&lt;br/&gt;
+      MergeMemNode* mm = initial_mem-&amp;gt;as_MergeMem();&lt;br/&gt;
+      Node* p = mm-&amp;gt;memory_at(load_alias_idx);&lt;br/&gt;
+      if (p != mm-&amp;gt;base_memory()) {&lt;br/&gt;
+        initial_mem = p;&lt;br/&gt;
+      } else break;&lt;br/&gt;
+    }&lt;br/&gt;
+  }&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;worklist_store.push(initial_mem);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;worklist_visited.push(initial_mem);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;worklist_mem.push(NULL);&lt;br/&gt;
</comment>
                            <comment id="14696066" author="iveresov" created="Mon, 5 Aug 2024 20:34:26 -0700"  >It seems that a load is sunk after a store in a violation of the correct memory dependency for some reason. GCM/LCM? Will need to debug it further...&lt;br/&gt;
&lt;br/&gt;
Good:&lt;br/&gt;
0e0   B12: #    B22 B13 &amp;lt;- B11  Freq: 4.9954&lt;br/&gt;
0e0     movzwl  RBX, [R8 + #14 + R11 &amp;lt;&amp;lt; #1]     # ushort/char&lt;br/&gt;
0e6     movzwl  R10, [R8 + #16 + RCX &amp;lt;&amp;lt; #1]     # ushort/char&lt;br/&gt;
0ec     movw    [R8 + #14 + R11 &amp;lt;&amp;lt; #1], R10     # char/short&lt;br/&gt;
0f2     movw    [R8 + #16 + RCX &amp;lt;&amp;lt; #1], RBX     # char/short&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
Bad:&lt;br/&gt;
e0   B12: #    B22 B13 &amp;lt;- B11  Freq: 4.99539&lt;br/&gt;
0e0     movzwl  R10, [R8 + #16 + RCX &amp;lt;&amp;lt; #1]     # ushort/char&lt;br/&gt;
0e6     movw    [R8 + #14 + R11 &amp;lt;&amp;lt; #1], R10     # char/short&lt;br/&gt;
0ec     movzwl  RBX, [R8 + #14 + R11 &amp;lt;&amp;lt; #1]     # ushort/char&lt;br/&gt;
0f2     movw    [R8 + #16 + RCX &amp;lt;&amp;lt; #1], RBX     # char/short</comment>
                            <comment id="14693264" author="thartmann" created="Mon, 29 Jul 2024 02:31:29 -0700"  >[~iveresov] could you please have a look?</comment>
                            <comment id="14693135" author="dbuck" created="Sat, 27 Jul 2024 14:48:46 -0700"  >C2 regression appears to be triggered by the backport of &lt;a href=&quot;https://bugs.openjdk.org/browse/JDK-8242115&quot; title=&quot;C2 SATB barriers are not safepoint-safe&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JDK-8242115&quot;&gt;&lt;strike&gt;JDK-8242115&lt;/strike&gt;&lt;/a&gt;.</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5143014">JDK-8343520</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5143020">JDK-8343526</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5141894">JDK-8342553</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5141896">JDK-8342555</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5141899">JDK-8342556</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5141900">JDK-8342557</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10003">
                    <name>Relates</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5015130">JDK-8242115</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="5141062">JDK-8341831</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5143209">JDK-8343687</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="111153" name="Bad graph.png" size="249195" author="iveresov" created="Wed, 18 Sep 2024 17:17:39 -0700"/>
                            <attachment id="111152" name="Good graph.png" size="373185" author="iveresov" created="Wed, 18 Sep 2024 17:17:39 -0700"/>
                            <attachment id="111109" name="graph.pdf" size="986559" author="iveresov" created="Mon, 16 Sep 2024 18:37:03 -0700"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i37a7v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17414"><![CDATA[b19]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="208"><![CDATA[compiler]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10100" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Verification</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17000"><![CDATA[Verified]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>