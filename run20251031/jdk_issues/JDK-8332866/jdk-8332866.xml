<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Sat Sep 27 09:06:07 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8332866] Crash in ImageIO JPEG decoding when MEM_STATS in enabled</title>
                <link>https://bugs.openjdk.org/browse/JDK-8332866</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>In IJG library&amp;#39;s jmemmgr.c file we can define MEM_STATS to enable printing of memory statistic logs when we have OOM. But if we enable it we get crash while disposing IJG stored objects in jmemmgr-&amp;gt;free-pool() function. &lt;br/&gt;
&lt;br/&gt;
#&lt;br/&gt;
# A fatal error has been detected by the Java Runtime Environment:&lt;br/&gt;
#&lt;br/&gt;
#  SIGSEGV (0xb) at pc=0x0000000103743164, pid=82400, tid=8707&lt;br/&gt;
#&lt;br/&gt;
# JRE version: Java(TM) SE Runtime Environment (23.0) (fastdebug build 23-internal-2024-05-24-0701510.jdv...)&lt;br/&gt;
# Java VM: Java HotSpot(TM) 64-Bit Server VM (fastdebug 23-internal-2024-05-24-0701510.jdv..., mixed mode, sharing, tiered, compressed oops, compressed class ptrs, g1 gc, bsd-aarch64)&lt;br/&gt;
# Problematic frame:&lt;br/&gt;
# C  [libjavajpeg.dylib+0x23164]  free_pool+0x50&lt;br/&gt;
#&lt;br/&gt;
# No core dump will be written. Core dumps have been disabled. To enable core dumping, try &amp;quot;ulimit -c unlimited&amp;quot; before starting Java again&lt;br/&gt;
#&lt;br/&gt;
# If you would like to submit a bug report, please visit:&lt;br/&gt;
#   &lt;a href=&quot;https://bugreport.java.com/bugreport/crash.jsp&quot;&gt;https://bugreport.java.com/bugreport/crash.jsp&lt;/a&gt;&lt;br/&gt;
# The crash happened outside the Java Virtual Machine in native code.&lt;br/&gt;
# See problematic frame for where to report the bug.&lt;br/&gt;
#&lt;br/&gt;
&lt;br/&gt;
---------------  S U M M A R Y ------------&lt;br/&gt;
&lt;br/&gt;
Command Line: -javaagent:/Applications/IntelliJ IDEA CE.app/Contents/lib/idea_rt.jar=49954:/Applications/IntelliJ IDEA CE.app/Contents/bin -Dfile.encoding=UTF-8 -Dsun.stdout.encoding=UTF-8 -Dsun.stderr.encoding=UTF-8 ImageDecoding&lt;br/&gt;
&lt;br/&gt;
Host: jdv-mac, &amp;quot;MacBookPro18,1&amp;quot; arm64, 10 cores, 32G, Darwin 23.3.0, macOS 14.3.1 (23D60)&lt;br/&gt;
Time: Fri May 24 13:27:36 2024 IST elapsed time: 5.160990 seconds (0d 0h 0m 5s)&lt;br/&gt;
&lt;br/&gt;
---------------  T H R E A D  ---------------&lt;br/&gt;
&lt;br/&gt;
Current thread (0x0000000153009810):  JavaThread &amp;quot;main&amp;quot;             [_thread_in_native, id=8707, stack(0x000000016dcd4000,0x000000016ded7000) (2060K)]&lt;br/&gt;
&lt;br/&gt;
Stack: [0x000000016dcd4000,0x000000016ded7000],  sp=0x000000016ded66c0,  free space=2057k&lt;br/&gt;
Native frames: (J=compiled Java code, j=interpreted, Vv=VM code, C=native code)&lt;br/&gt;
C  [libjavajpeg.dylib+0x23164]  free_pool+0x50&lt;br/&gt;
C  [libjavajpeg.dylib+0x23324]  self_destruct+0x18&lt;br/&gt;
C  [libjavajpeg.dylib+0xdf34]  jDestroy+0x24&lt;br/&gt;
C  [libjavajpeg.dylib+0x409c]  Java_com_sun_imageio_plugins_jpeg_JPEGImageReader_disposeReader+0x40&lt;br/&gt;
&lt;br/&gt;
This is happening because we delete the error handler before we actually start deleting IJG stored objects and while freeing the IJG objects we try to access cinfo-&amp;gt;err-&amp;gt;trace_level of error handler. This early deletion of error handler is happening in jpegloader.c-&amp;gt;imageio_dispose() function. We should delete error handler after we are done with deleting IJG stored objects. </description>
                <environment></environment>
        <key id="5130234">JDK-8332866</key>
            <summary>Crash in ImageIO JPEG decoding when MEM_STATS in enabled</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://bugs.openjdk.org/images/jbsImages/p3.png">P3</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jdv">Jayathirth D V</assignee>
                                    <reporter username="jdv">Jayathirth D V</reporter>
                        <labels>
                            <label>amazon-interest</label>
                            <label>jdk17u-fix-request</label>
                            <label>jdk17u-fix-yes</label>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                            <label>noreg-hard</label>
                            <label>sn_170</label>
                            <label>sn_171</label>
                    </labels>
                <created>Fri, 24 May 2024 01:10:48 -0700</created>
                <updated>Wed, 6 Nov 2024 00:35:12 -0800</updated>
                            <resolved>Mon, 3 Jun 2024 22:12:58 -0700</resolved>
                                    <version>17</version>
                    <version>21</version>
                    <version>23</version>
                                    <fixVersion>23</fixVersion>
                                    <component>client-libs</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14714317" author="roboduke" created="Wed, 16 Oct 2024 19:57:53 -0700"  >[jdk17u-fix-request] Approval Request from Satyen Subramaniam&lt;br/&gt;
Clean backport. Existing code is buggy when we define MEM_STATS to enable printing of memory statistic logs, leading to crash while disposing IJG stored objects in jmemmgr-&amp;gt;free-pool() function. Change only reorders freeing of memory within `imageio_dispose()` function. Tested with tier1, tier2, and GHA tests. Risk is low.</comment>
                            <comment id="14714303" author="roboduke" created="Wed, 16 Oct 2024 19:55:18 -0700"  >[jdk21u-fix-request] Approval Request from Satyen Subramaniam&lt;br/&gt;
Clean backport. Existing code is buggy when we define MEM_STATS to enable printing of memory statistic logs, leading to crash while disposing IJG stored objects in jmemmgr-&amp;gt;free-pool() function. Change only reorders freeing of memory within `imageio_dispose()` function. Tested with tier1, tier2, and GHA tests. Risk is low.</comment>
                            <comment id="14713701" author="roboduke" created="Wed, 16 Oct 2024 10:51:11 -0700"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk17u-dev/pull/2968&quot;&gt;https://git.openjdk.org/jdk17u-dev/pull/2968&lt;/a&gt;&lt;br/&gt;
Date: 2024-10-16 17:43:29 +0000</comment>
                            <comment id="14713697" author="roboduke" created="Wed, 16 Oct 2024 10:33:05 -0700"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u-dev/pull/1058&quot;&gt;https://git.openjdk.org/jdk21u-dev/pull/1058&lt;/a&gt;&lt;br/&gt;
Date: 2024-10-16 17:26:29 +0000</comment>
                            <comment id="14678560" author="dukebot" created="Mon, 3 Jun 2024 22:12:57 -0700"  >Changeset: ca307263&lt;br/&gt;
Author:    Jayathirth D V &amp;lt;&lt;a href=&apos;mailto:jdv@openjdk.org&apos;&gt;jdv@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2024-06-04 05:11:41 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/ca3072635215755766575b4eb70dc6267969a550&quot;&gt;https://git.openjdk.org/jdk/commit/ca3072635215755766575b4eb70dc6267969a550&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14675925" author="roboduke" created="Fri, 24 May 2024 01:43:25 -0700"  >A pull request was submitted for review.&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/19386&quot;&gt;https://git.openjdk.org/jdk/pull/19386&lt;/a&gt;&lt;br/&gt;
Date: 2024-05-24 08:37:25 +0000</comment>
                            <comment id="14675921" author="jdv" created="Fri, 24 May 2024 01:13:36 -0700"  >This issue happens only in ImageIO path and not in SplashScreen path. Because in case of SplashScreen we have different dispose logic.&lt;br/&gt;
I have verified this difference in behaviour using SplashDemo and .jpg file for splashscreen. So we don&amp;#39;t need any change in jpegdecoder.c wrapper.</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5141893">JDK-8342552</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5141895">JDK-8342554</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5142284">JDK-8342890</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5142560">JDK-8343138</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5142561">JDK-8343139</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5142564">JDK-8343142</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10000" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>CPU</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17008"><![CDATA[generic]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_10005" key="com.atlassian.jira.plugin.system.customfieldtypes:multiselect">
                        <customfieldname>OS</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17010"><![CDATA[generic]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i36gpv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17357"><![CDATA[b26]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="323"><![CDATA[javax.imageio]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>