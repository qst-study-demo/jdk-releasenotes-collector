<!-- 
RSS generated by JIRA (9.12.27#9120027-sha1:edc4490121e366e9e7bd2213d532dbe7e028fc5d) at Sat Sep 27 09:58:13 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>Java Bug System</title>
    <link>https://bugs.openjdk.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>9.12.27</version>
        <build-number>9120027</build-number>
        <build-date>02-09-2025</build-date>
    </build-info>


<item>
            <title>[JDK-8343144] UpcallLinker::on_entry racingly clears pending exception with GC safepoints</title>
                <link>https://bugs.openjdk.org/browse/JDK-8343144</link>
                <project id="10100" key="JDK">JDK</project>
                    <description>In UpcallLinker::on_entry we clear_pending_exception() right before transitioning from native to Java. This clears an oop on the thread that might be concurrently scanned by the GC. The GC may read the oop and update its address to a new location, without using any atomics at all (because we are in a safepoint and nobody should be messing around with it concurrently). The lack of atomics means that the following interleaving is possible:&lt;br/&gt;
&lt;br/&gt;
GCThread: old_oop = JT1-&amp;gt;_pending_exception&lt;br/&gt;
JT1: clear_pending_exception()&lt;br/&gt;
GCThread: JT1-&amp;gt;_pending_exception = new_addr(old_oop);&lt;br/&gt;
&lt;br/&gt;
Other interesting things can happen as well. But it&amp;#39;s safe to say we shouldn&amp;#39;t be messing around with oops in_native concurrently to GC safepoints.</description>
                <environment></environment>
        <key id="5142568">JDK-8343144</key>
            <summary>UpcallLinker::on_entry racingly clears pending exception with GC safepoints</summary>
                <type id="1" iconUrl="https://bugs.openjdk.org/secure/viewavatar?size=xsmall&amp;avatarId=14703&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://bugs.openjdk.org/images/jbsImages/p4.png">P4</priority>
                        <status id="5" iconUrl="https://bugs.openjdk.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="success"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jvernee">Jorn Vernee</assignee>
                                    <reporter username="eosterlund">Erik &#214;sterlund</reporter>
                        <labels>
                            <label>jdk21u-fix-request</label>
                            <label>jdk21u-fix-yes</label>
                    </labels>
                <created>Mon, 28 Oct 2024 04:55:20 -0700</created>
                <updated>Tue, 15 Apr 2025 13:28:18 -0700</updated>
                            <resolved>Wed, 27 Nov 2024 04:24:49 -0800</resolved>
                                                    <fixVersion>24</fixVersion>
                                    <component>core-libs</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="14755309" author="roboduke" created="Thu, 20 Feb 2025 09:30:34 -0800"  >[jdk21u-fix-request] Approval Request from Andrew Hughes&lt;br/&gt;
Clean backport of a fix for a race condition in the FFM API. Can lead to crashes when the FFM code manipulates a frame anchor in native mode, which the GC does not expect to happen. Fix is to move the frame anchor copying to Java mode, where the GC will wait for the thread to get to a safepoint. Risk to other code is low as the UpcallLinker is only used by FFM.</comment>
                            <comment id="14755293" author="roboduke" created="Thu, 20 Feb 2025 08:29:53 -0800"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk21u-dev/pull/1424&quot;&gt;https://git.openjdk.org/jdk21u-dev/pull/1424&lt;/a&gt;&lt;br/&gt;
Date: 2025-02-20 16:23:03 +0000</comment>
                            <comment id="14726503" author="dukebot" created="Wed, 27 Nov 2024 04:24:48 -0800"  >Changeset: 461ffafe&lt;br/&gt;
Branch: master&lt;br/&gt;
Author:    Jorn Vernee &amp;lt;&lt;a href=&apos;mailto:jvernee@openjdk.org&apos;&gt;jvernee@openjdk.org&lt;/a&gt;&amp;gt;&lt;br/&gt;
Date:      2024-11-27 12:20:51 +0000&lt;br/&gt;
URL:       &lt;a href=&quot;https://git.openjdk.org/jdk/commit/461ffafeba459c077f1c2d9c5037305b71a8bc2a&quot;&gt;https://git.openjdk.org/jdk/commit/461ffafeba459c077f1c2d9c5037305b71a8bc2a&lt;/a&gt;&lt;br/&gt;
</comment>
                            <comment id="14723125" author="roboduke" created="Mon, 18 Nov 2024 04:49:54 -0800"  >A pull request was submitted for review.&lt;br/&gt;
Branch: master&lt;br/&gt;
URL: &lt;a href=&quot;https://git.openjdk.org/jdk/pull/21742&quot;&gt;https://git.openjdk.org/jdk/pull/21742&lt;/a&gt;&lt;br/&gt;
Date: 2024-10-28 13:53:58 +0000</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10200">
                    <name>Backport</name>
                                            <outwardlinks description="backported by">
                                        <issuelink>
            <issuekey id="5151701">JDK-8350949</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="5155971">JDK-8354712</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_11700" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10600" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-fixedBackportedCustomfield">
                        <customfieldname>Fixed</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_11100" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i38i1n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_11004" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10006" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Resolved In Build</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="17357"><![CDATA[b26]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10008" key="com.oracle.jira.jira-subcomponent-plugin:oracle-subComponentField">
                        <customfieldname>Subcomponent</customfieldname>
                        <customfieldvalues>
                             <customfieldvalue key="2492"><![CDATA[java.lang.foreign]]></customfieldvalue> 
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10601" key="com.oracle.jira.javabugsystem-jira-plugin:jbs-targetBackportedCustomfield">
                        <customfieldname>Targeted</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>